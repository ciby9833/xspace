import{x as U,r as j,k as J,b as Se,l as ve,c as M,o as r,n as E,w as s,g as t,e as i,h as o,d as _,s as V,v as ae,I as Ae,f as S,H as ze,t as y,i as D,P as Ce,m as N,J as Ne,K as ke,E as Ie,a as Le,q as Ye,S as Pe,L as Ee,M as Qe,N as Ze,O as De,y as je,Q as we}from"./index-979b8016.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{F as $e,S as Oe}from"./StopOutlined-b4edf275.js";const Be=v=>U({url:"/api/script",method:"get",params:v}),Fe=v=>U({url:`/api/script/${v}`,method:"get"}),We=v=>U({url:"/api/script",method:"post",data:v}),Ue=(v,Q)=>U({url:`/api/script/${v}`,method:"put",data:Q}),Ge=v=>U({url:`/api/script/${v}`,method:"delete"}),Re=v=>U({url:"/api/script/upload-images",method:"post",data:v,headers:{"Content-Type":"multipart/form-data"}}),be=v=>U({url:"/api/script/batch",method:"post",data:v}),Te=()=>U({url:"/api/script/company-stores",method:"get"}),Je=(v,Q)=>U({url:`/api/script/${v}/stores`,method:"post",data:{storeConfigs:Q}}),xe=v=>U({url:`/api/script/${v}/stores`,method:"get"});const Ve={class:"form-section"},He={class:"form-section"},qe={class:"image-upload-container"},Ke=["onDragstart","onDrop"],Xe=["src","onLoad"],et={class:"image-overlay"},tt={class:"image-order"},st={key:1,class:"upload-area"},at={key:2,class:"sort-tip"},lt={class:"store-config-container"},ot={class:"store-config-header"},it={key:0,class:"store-config-list"},nt={class:"store-info"},rt={class:"store-name"},ut={class:"store-address"},dt={key:0,class:"store-price-input"},ct={key:1,class:"no-stores"},pt={key:2,class:"stores-loading"},_t={__name:"ScriptFormModal",props:{visible:{type:Boolean,default:!1},scriptData:{type:Object,default:null},isEdit:{type:Boolean,default:!1}},emits:["update:visible","success"],setup(v,{emit:Q}){const I=v,le=Q,Z=j(),B=j(!1),x=j(!1),h=j(0),b=j(-1),C=j([]),A=j(!1),k=j([]),F=J({get:()=>I.visible,set:l=>le("update:visible",l)}),c=Se({name:"",type:"",background:"",description:"",min_players:1,max_players:6,duration:120,difficulty:"进阶",price:null,images:[],tags:[],props:"",is_active:!0}),O={name:[{required:!0,message:"请输入剧本名称",trigger:"blur"},{min:2,max:100,message:"剧本名称长度为2-100个字符",trigger:"blur"}],type:[{required:!0,message:"请选择剧本类型",trigger:"change"}],min_players:[{required:!0,message:"请输入最少人数",trigger:"blur"},{type:"number",min:1,max:20,message:"最少人数应在1-20之间",trigger:"blur"}],max_players:[{required:!0,message:"请输入最多人数",trigger:"blur"},{type:"number",min:1,max:20,message:"最多人数应在1-20之间",trigger:"blur"},{validator:(l,e)=>e<c.min_players?Promise.reject("最多人数不能少于最少人数"):Promise.resolve(),trigger:"blur"}],duration:[{required:!0,message:"请输入游戏时长",trigger:"blur"},{type:"number",min:30,max:600,message:"游戏时长应在30-600分钟之间",trigger:"blur"}],difficulty:[{required:!0,message:"请选择难度等级",trigger:"change"}]},W=async l=>{if(!l.type.startsWith("image/"))return N.error("只能上传图片文件！"),!1;if(!(l.size/1024/1024<5))return N.error("图片大小不能超过5MB！"),!1;if(c.images.length>=10)return N.error("最多只能上传10张图片！"),!1;try{x.value=!0;const g=new FormData;g.append("images",l);const z=await Re(g);z.data&&z.data.images?(c.images.push(...z.data.images),console.log("图片上传成功，当前图片数组:",c.images),h.value++,N.success(`成功上传 ${z.data.count} 张图片`)):(console.error("图片上传响应格式异常:",z),N.error("图片上传失败：响应格式异常"))}catch(g){console.error("图片上传失败:",g),N.error("图片上传失败")}finally{x.value=!1}return!1},ie=l=>{c.images.splice(l,1),h.value++,N.success("移除图片成功")},H=(l,e)=>{b.value=l,e.target.classList.add("dragging"),e.dataTransfer.effectAllowed="move"},G=l=>{l.target.classList.remove("dragging"),b.value=-1},X=l=>{var e;l.preventDefault(),(e=l.target.closest(".image-item"))==null||e.classList.add("drag-over")},ee=l=>{var e;(e=l.target.closest(".image-item"))==null||e.classList.remove("drag-over")},q=(l,e)=>{var z;if(e.preventDefault(),(z=e.target.closest(".image-item"))==null||z.classList.remove("drag-over"),b.value===-1||b.value===l)return;const u=c.images[b.value];c.images.splice(b.value,1);const g=b.value<l?l-1:l;c.images.splice(g,0,u),b.value=-1,h.value++,N.success("图片顺序调整成功")},L=l=>l?l.startsWith("http")||l.startsWith("/")?l:`/${l}`:"",ne=l=>{console.error("图片加载失败:",l.target.src),l.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},f=async()=>{try{A.value=!0;const l=await Te();C.value=l.data||[]}catch(l){console.error("获取门店列表失败:",l),N.error("获取门店列表失败")}finally{A.value=!1}},m=async l=>{if(l)try{console.log("开始获取剧本门店配置:",l);const u=(await xe(l)).data||[];console.log("获取到的门店配置:",u),k.value=u.map(g=>({store_id:g.store_id,store_price:g.store_price,is_available:g.is_available!==!1})),console.log("转换后的门店配置:",k.value)}catch(e){console.error("获取剧本门店配置失败:",e),k.value=[]}},$=l=>k.value.some(e=>e.store_id===l),R=l=>{const e=k.value.find(u=>u.store_id===l);return e?e.store_price:null},re=(l,e)=>{e?$(l)||k.value.push({store_id:l,store_price:c.price||null,is_available:!0}):k.value=k.value.filter(u=>u.store_id!==l)},oe=(l,e)=>{const u=k.value.find(g=>g.store_id===l);u&&(u.store_price=e)},ue=()=>{C.value.forEach(l=>{$(l.id)||k.value.push({store_id:l.id,store_price:c.price||null,is_available:!0})})},K=()=>{var l;console.log("重置表单"),Object.assign(c,{name:"",type:"",background:"",description:"",min_players:1,max_players:6,duration:120,difficulty:"进阶",price:null,images:[],tags:[],props:"",is_active:!0}),k.value=[],h.value++,(l=Z.value)==null||l.resetFields()};ve(()=>I.scriptData,async(l,e)=>{console.log("scriptData 变化:",{newData:l,oldData:e,isEdit:I.isEdit}),l&&I.isEdit&&(console.log("编辑模式，接收到剧本数据:",l),Object.keys(c).forEach(u=>{l[u]!==void 0&&(u==="tags"?c[u]=Array.isArray(l[u])?l[u]:typeof l[u]=="string"?JSON.parse(l[u]||"[]"):[]:u==="images"?c[u]=Array.isArray(l[u])?l[u]:typeof l[u]=="string"?JSON.parse(l[u]||"[]"):[]:c[u]=l[u])}),l.id&&(C.value.length===0&&!A.value&&await f(),await m(l.id)))},{immediate:!1}),ve([()=>I.visible,()=>I.isEdit],([l,e],[u,g])=>{console.log("弹窗状态变化:",{visible:l,isEdit:e,oldVisible:u,oldIsEdit:g}),l&&(console.log("弹窗显示，编辑模式:",e),f(),e||(console.log("新增模式，重置表单"),Ne(()=>{K()})))},{immediate:!0}),ve(()=>I.isEdit,(l,e)=>{console.log("编辑模式变化:",{isEdit:l,oldIsEdit:e,visible:I.visible}),I.visible&&!l&&e!==void 0&&(console.log("从编辑模式切换到新增模式，重置表单"),Ne(()=>{K()}))});const de=async()=>{var l;try{await Z.value.validate(),B.value=!0;const e={...c,tags:c.tags.length>0?c.tags:null,images:c.images.length>0?c.images:[]};let u;if(I.isEdit){const g=await Ue(I.scriptData.id,e);u=I.scriptData.id,N.success("编辑剧本成功")}else{const g=await We(e);u=((l=g.data)==null?void 0:l.id)||g.id,N.success("创建剧本成功")}if(u)try{console.log("保存门店配置:",k.value),await Je(u,k.value),console.log("门店配置保存成功"),k.value.length>0&&N.success(`剧本保存成功，已配置 ${k.value.length} 个门店`)}catch(g){console.error("门店配置保存失败:",g),N.warning("剧本保存成功，但门店配置保存失败")}le("success"),F.value=!1,K()}catch(e){console.error("提交失败:",e),e.errorFields?N.error("请检查表单信息"):N.error(I.isEdit?"编辑剧本失败":"创建剧本失败")}finally{B.value=!1}},ce=()=>{K(),F.value=!1};return(l,e)=>{const u=M("a-input"),g=M("a-form-item"),z=M("a-select-option"),d=M("a-select"),a=M("a-input-number"),P=M("a-switch"),w=M("a-col"),te=M("a-row"),T=M("a-button"),me=M("a-upload"),_e=M("a-form-item-rest"),pe=M("a-textarea"),se=M("a-checkbox"),fe=M("a-empty"),ge=M("a-spin"),ye=M("a-form"),Me=M("a-modal");return r(),E(Me,{open:F.value,"onUpdate:open":e[13]||(e[13]=n=>F.value=n),title:v.isEdit?"编辑剧本":"新增剧本",width:"900px","confirm-loading":B.value,onOk:de,onCancel:ce},{default:s(()=>[t(ye,{ref_key:"formRef",ref:Z,model:c,rules:O,"label-col":{span:6},"wrapper-col":{span:18},layout:"horizontal"},{default:s(()=>[t(te,{gutter:24},{default:s(()=>[t(w,{span:12},{default:s(()=>[i("div",Ve,[e[31]||(e[31]=i("h3",{class:"section-title"},"基本信息",-1)),t(g,{label:"剧本名称",name:"name"},{default:s(()=>[t(u,{value:c.name,"onUpdate:value":e[0]||(e[0]=n=>c.name=n),placeholder:"请输入剧本名称",maxlength:"100"},null,8,["value"])]),_:1}),t(g,{label:"剧本类型",name:"type"},{default:s(()=>[t(d,{value:c.type,"onUpdate:value":e[1]||(e[1]=n=>c.type=n),placeholder:"请选择剧本类型"},{default:s(()=>[t(z,{value:"欢乐"},{default:s(()=>e[14]||(e[14]=[o("欢乐")])),_:1,__:[14]}),t(z,{value:"惊悚"},{default:s(()=>e[15]||(e[15]=[o("惊悚")])),_:1,__:[15]}),t(z,{value:"推理"},{default:s(()=>e[16]||(e[16]=[o("推理")])),_:1,__:[16]}),t(z,{value:"恐怖"},{default:s(()=>e[17]||(e[17]=[o("恐怖")])),_:1,__:[17]}),t(z,{value:"情感"},{default:s(()=>e[18]||(e[18]=[o("情感")])),_:1,__:[18]}),t(z,{value:"策略"},{default:s(()=>e[19]||(e[19]=[o("策略")])),_:1,__:[19]}),t(z,{value:"血染钟楼"},{default:s(()=>e[20]||(e[20]=[o("血染钟楼")])),_:1,__:[20]}),t(z,{value:"桌游"},{default:s(()=>e[21]||(e[21]=[o("桌游")])),_:1,__:[21]})]),_:1},8,["value"])]),_:1}),t(g,{label:"剧本背景",name:"background"},{default:s(()=>[t(d,{value:c.background,"onUpdate:value":e[2]||(e[2]=n=>c.background=n),placeholder:"请选择剧本背景","allow-clear":""},{default:s(()=>[t(z,{value:"现代"},{default:s(()=>e[22]||(e[22]=[o("现代")])),_:1,__:[22]}),t(z,{value:"中国古代"},{default:s(()=>e[23]||(e[23]=[o("中国古代")])),_:1,__:[23]}),t(z,{value:"欧式"},{default:s(()=>e[24]||(e[24]=[o("欧式")])),_:1,__:[24]}),t(z,{value:"日式"},{default:s(()=>e[25]||(e[25]=[o("日式")])),_:1,__:[25]}),t(z,{value:"架空"},{default:s(()=>e[26]||(e[26]=[o("架空")])),_:1,__:[26]})]),_:1},8,["value"])]),_:1}),t(g,{label:"难度等级",name:"difficulty"},{default:s(()=>[t(d,{value:c.difficulty,"onUpdate:value":e[3]||(e[3]=n=>c.difficulty=n),placeholder:"请选择难度等级"},{default:s(()=>[t(z,{value:"新手"},{default:s(()=>e[27]||(e[27]=[o("新手")])),_:1,__:[27]}),t(z,{value:"进阶"},{default:s(()=>e[28]||(e[28]=[o("进阶")])),_:1,__:[28]}),t(z,{value:"硬核"},{default:s(()=>e[29]||(e[29]=[o("硬核")])),_:1,__:[29]})]),_:1},8,["value"])]),_:1}),t(g,{label:"建议价格",name:"price"},{default:s(()=>[t(a,{value:c.price,"onUpdate:value":e[4]||(e[4]=n=>c.price=n),placeholder:"建议价格",min:0,precision:0,formatter:n=>`Rp ${n}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:n=>n.replace(/Rp\s?|(,*)/g,""),style:{width:"100%"}},{addonAfter:s(()=>e[30]||(e[30]=[o("IDR")])),_:1},8,["value","formatter","parser"])]),_:1}),t(g,{label:"状态",name:"is_active"},{default:s(()=>[t(P,{checked:c.is_active,"onUpdate:checked":e[5]||(e[5]=n=>c.is_active=n),"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])]),_:1})])]),_:1}),t(w,{span:12},{default:s(()=>[i("div",He,[e[38]||(e[38]=i("h3",{class:"section-title"},"游戏设置",-1)),t(g,{label:"最少人数",name:"min_players"},{default:s(()=>[t(a,{value:c.min_players,"onUpdate:value":e[6]||(e[6]=n=>c.min_players=n),placeholder:"最少人数",min:1,max:20,style:{width:"100%"}},null,8,["value"])]),_:1}),t(g,{label:"最多人数",name:"max_players"},{default:s(()=>[t(a,{value:c.max_players,"onUpdate:value":e[7]||(e[7]=n=>c.max_players=n),placeholder:"最多人数",min:c.min_players||1,max:20,style:{width:"100%"}},null,8,["value","min"])]),_:1}),t(g,{label:"游戏时长",name:"duration"},{default:s(()=>[t(a,{value:c.duration,"onUpdate:value":e[8]||(e[8]=n=>c.duration=n),placeholder:"游戏时长",min:30,max:600,step:15,style:{width:"100%"}},{addonAfter:s(()=>e[32]||(e[32]=[o("分钟")])),_:1},8,["value"])]),_:1}),t(g,{label:"标签",name:"tags"},{default:s(()=>[t(d,{value:c.tags,"onUpdate:value":e[9]||(e[9]=n=>c.tags=n),mode:"tags",placeholder:"添加标签，回车确认","max-tag-count":8,style:{width:"100%"}},{default:s(()=>[t(z,{value:"新手友好"},{default:s(()=>e[33]||(e[33]=[o("新手友好")])),_:1,__:[33]}),t(z,{value:"烧脑"},{default:s(()=>e[34]||(e[34]=[o("烧脑")])),_:1,__:[34]}),t(z,{value:"热门"},{default:s(()=>e[35]||(e[35]=[o("热门")])),_:1,__:[35]}),t(z,{value:"经典"},{default:s(()=>e[36]||(e[36]=[o("经典")])),_:1,__:[36]}),t(z,{value:"团建"},{default:s(()=>e[37]||(e[37]=[o("团建")])),_:1,__:[37]})]),_:1},8,["value"])]),_:1})])]),_:1})]),_:1}),t(te,null,{default:s(()=>[t(w,{span:24},{default:s(()=>[t(g,{label:"剧本图片","label-col":{span:3},"wrapper-col":{span:21}},{default:s(()=>[t(_e,null,{default:s(()=>[i("div",qe,[c.images.length>0?(r(),_("div",{class:"image-list",key:h.value},[(r(!0),_(V,null,ae(c.images,(n,p)=>(r(),_("div",{key:`image-${p}-${n}`,class:"image-item",draggable:"true",onDragstart:Y=>H(p,Y),onDragend:G,onDragover:e[10]||(e[10]=Ae(()=>{},["prevent"])),onDragenter:X,onDragleave:ee,onDrop:Y=>q(p,Y)},[i("img",{src:L(n),onError:ne,onLoad:()=>console.log("图片加载成功:",n)},null,40,Xe),i("div",et,[t(T,{type:"text",size:"small",danger:"",onClick:Y=>ie(p)},{default:s(()=>[t(S(ze))]),_:2},1032,["onClick"])]),i("div",tt,y(p+1),1),e[39]||(e[39]=i("div",{class:"drag-handle"},"⋮⋮",-1))],40,Ke))),128))])):D("",!0),c.images.length<10?(r(),_("div",st,[t(me,{"file-list":[],multiple:!0,"before-upload":W,"show-upload-list":!1,accept:"image/*"},{default:s(()=>[t(T,{loading:x.value},{default:s(()=>[t(S(Ce)),e[40]||(e[40]=o(" 上传图片 "))]),_:1,__:[40]},8,["loading"])]),_:1}),e[41]||(e[41]=i("div",{class:"upload-tips"},[o(" 最多上传10张图片，单张不超过5MB"),i("br"),o(" 支持 JPG、PNG、GIF、WebP 格式 ")],-1))])):D("",!0),c.images.length>1?(r(),_("div",at," 💡 可拖拽图片调整显示顺序 ")):D("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),t(te,null,{default:s(()=>[t(w,{span:24},{default:s(()=>[t(g,{label:"剧本描述",name:"description","label-col":{span:3},"wrapper-col":{span:21}},{default:s(()=>[t(pe,{value:c.description,"onUpdate:value":e[11]||(e[11]=n=>c.description=n),placeholder:"请输入剧本描述",rows:4,maxlength:"500","show-count":""},null,8,["value"])]),_:1}),t(g,{label:"剧本道具",name:"props","label-col":{span:3},"wrapper-col":{span:21}},{default:s(()=>[t(pe,{value:c.props,"onUpdate:value":e[12]||(e[12]=n=>c.props=n),placeholder:"请输入剧本道具说明（如特殊道具、材料要求等）",rows:3,maxlength:"300","show-count":""},null,8,["value"])]),_:1}),t(g,{label:"上架门店","label-col":{span:3},"wrapper-col":{span:21}},{default:s(()=>[i("div",lt,[t(_e,null,{default:s(()=>[i("div",ot,[e[43]||(e[43]=i("span",null,"选择要上架的门店并设置价格",-1)),C.value.length>0?(r(),E(T,{key:0,type:"link",size:"small",onClick:ue},{default:s(()=>e[42]||(e[42]=[o(" 全选 ")])),_:1,__:[42]})):D("",!0)]),C.value.length>0?(r(),_("div",it,[(r(!0),_(V,null,ae(C.value,n=>(r(),_("div",{key:n.id,class:"store-config-item"},[t(se,{checked:$(n.id),onChange:p=>re(n.id,p.target.checked)},{default:s(()=>[i("div",nt,[i("span",rt,y(n.name),1),i("span",ut,y(n.address),1)])]),_:2},1032,["checked","onChange"]),$(n.id)?(r(),_("div",dt,[t(a,{value:R(n.id),onChange:p=>oe(n.id,p),placeholder:"门店价格",min:0,precision:0,formatter:p=>p?new Intl.NumberFormat("id-ID").format(p):"",parser:p=>p.replace(/\D/g,""),size:"small",style:{width:"140px"}},{addonBefore:s(()=>e[44]||(e[44]=[o("Rp")])),_:2},1032,["value","onChange","formatter","parser"])])):D("",!0)]))),128))])):A.value?D("",!0):(r(),_("div",ct,[t(fe,{description:"暂无可用门店"})])),A.value?(r(),_("div",pt,[t(ge,{size:"small"}),e[45]||(e[45]=i("span",{style:{"margin-left":"8px"}},"加载门店列表...",-1))])):D("",!0)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])}}},gt=he(_t,[["__scopeId","data-v-6ea0076d"]]);const vt={key:0,class:"script-detail"},mt={class:"detail-section"},ft={class:"script-header"},yt={key:0,class:"script-images"},Mt=["src","alt"],bt={class:"image-preview-hint"},zt={key:0,class:"image-thumbnails"},kt=["onClick"],It=["src"],ht={key:1,class:"no-image"},Nt={class:"no-image-placeholder"},Dt={class:"script-basic"},jt={class:"script-name"},wt={class:"script-meta"},St={key:0,class:"price"},Ct={key:1,class:"no-price"},$t={key:0,class:"tags-section"},xt={class:"tags-container"},At={class:"detail-section"},Lt={key:0,class:"content-block"},Yt={class:"content-text"},Pt={key:1,class:"content-block"},Et={class:"content-text"},Qt={class:"content-block"},Zt={class:"store-stats"},Ot={key:0,class:"store-configs"},Bt={class:"store-config-item"},Ft={class:"store-info"},Wt={class:"store-main-info"},Ut={class:"store-name"},Gt={key:0,class:"store-address"},Rt={class:"store-price"},Tt={key:0,class:"price"},Jt={key:1,class:"no-price"},Vt={key:1,class:"no-stores"},Ht={class:"image-preview-container"},qt={class:"main-preview"},Kt=["src","alt"],Xt={key:0,class:"preview-thumbnails"},es=["onClick"],ts=["src"],ss={class:"preview-info"},as={__name:"ScriptDetailModal",props:{visible:{type:Boolean,default:!1},scriptData:{type:Object,default:null}},emits:["update:visible"],setup(v,{emit:Q}){const I=v,le=Q,Z=j(0),B=j(!1),x=j([]),h=j(0),b=j([]),C=j(!1),A=J({get:()=>I.visible,set:f=>le("update:visible",f)}),k=J(()=>{var f;if(!((f=I.scriptData)!=null&&f.images))return[];if(Array.isArray(I.scriptData.images))return I.scriptData.images;try{return JSON.parse(I.scriptData.images)}catch{return[]}}),F=J(()=>k.value.length===0?"":k.value[Z.value]||k.value[0]),c=J(()=>{var f;if(!((f=I.scriptData)!=null&&f.tags))return[];if(Array.isArray(I.scriptData.tags))return I.scriptData.tags;try{return JSON.parse(I.scriptData.tags)}catch{return[]}}),O=J(()=>b.value.filter(f=>f!==null)),W=async f=>{if(f)try{C.value=!0;const m=await xe(f);b.value=m.data||[],console.log("获取门店配置成功:",b.value)}catch(m){console.error("获取门店配置失败:",m),b.value=[]}finally{C.value=!1}};ve([()=>I.visible,()=>I.scriptData],([f,m])=>{f&&(m!=null&&m.id)&&W(m.id)},{immediate:!0});const ie=()=>{Z.value=0,b.value=[],A.value=!1},H=f=>f?f.startsWith("http")?f:`http://localhost:3000${f}`:"",G=f=>({欢乐:"orange",惊悚:"purple",推理:"blue",恐怖:"red",情感:"pink",策略:"green",血染钟楼:"volcano",桌游:"cyan"})[f]||"default",X=f=>({新手:"green",进阶:"blue",硬核:"red"})[f]||"default",ee=f=>({现代:"blue",中国古代:"gold",欧式:"purple",日式:"magenta",架空:"cyan"})[f]||"default",q=f=>{f.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},L=f=>f?new Intl.NumberFormat("id-ID").format(f):"0",ne=(f,m)=>{!f||f.length===0||(x.value=f,h.value=m,B.value=!0)};return(f,m)=>{const $=M("a-tag"),R=M("a-descriptions-item"),re=M("a-descriptions"),oe=M("a-col"),ue=M("a-statistic"),K=M("a-list-item"),de=M("a-list"),ce=M("a-empty"),l=M("a-row"),e=M("a-modal");return r(),_(V,null,[t(e,{open:A.value,"onUpdate:open":m[1]||(m[1]=u=>A.value=u),title:"剧本详情",width:"1000px",footer:null,onCancel:ie},{default:s(()=>[v.scriptData?(r(),_("div",vt,[t(l,{gutter:24},{default:s(()=>[t(oe,{span:12},{default:s(()=>[i("div",mt,[m[6]||(m[6]=i("h3",{class:"section-title"},"基本信息",-1)),i("div",ft,[k.value.length>0?(r(),_("div",yt,[i("div",{class:"main-image",onClick:m[0]||(m[0]=u=>ne(k.value,Z.value))},[i("img",{src:H(F.value),alt:v.scriptData.name,onError:q},null,40,Mt),i("div",bt,[t(S(ke)),m[3]||(m[3]=o(" 点击放大 "))])]),k.value.length>1?(r(),_("div",zt,[(r(!0),_(V,null,ae(k.value,(u,g)=>(r(),_("div",{key:g,class:Ie(["thumbnail",{active:Z.value===g}]),onClick:z=>Z.value=g},[i("img",{src:H(u),onError:q},null,40,It)],10,kt))),128))])):D("",!0)])):(r(),_("div",ht,[i("div",Nt,[t(S($e)),m[4]||(m[4]=i("span",null,"暂无图片",-1))])])),i("div",Dt,[i("h2",jt,y(v.scriptData.name),1),i("div",wt,[t($,{color:G(v.scriptData.type)},{default:s(()=>[o(y(v.scriptData.type),1)]),_:1},8,["color"]),v.scriptData.background?(r(),E($,{key:0,color:ee(v.scriptData.background)},{default:s(()=>[o(y(v.scriptData.background),1)]),_:1},8,["color"])):D("",!0),t($,{color:X(v.scriptData.difficulty)},{default:s(()=>[o(y(v.scriptData.difficulty),1)]),_:1},8,["color"]),t($,{color:v.scriptData.is_active?"green":"red"},{default:s(()=>[o(y(v.scriptData.is_active?"启用":"禁用"),1)]),_:1},8,["color"])])])]),t(re,{column:1,size:"small",class:"detail-descriptions"},{default:s(()=>[t(R,{label:"游戏人数"},{default:s(()=>[o(y(v.scriptData.min_players)+"-"+y(v.scriptData.max_players)+"人 ",1)]),_:1}),t(R,{label:"游戏时长"},{default:s(()=>[o(y(v.scriptData.duration)+"分钟 ",1)]),_:1}),t(R,{label:"建议价格"},{default:s(()=>[v.scriptData.price?(r(),_("span",St,"Rp "+y(L(v.scriptData.price)),1)):(r(),_("span",Ct,"未设置"))]),_:1}),t(R,{label:"创建时间"},{default:s(()=>[o(y(v.scriptData.created_at),1)]),_:1}),t(R,{label:"更新时间"},{default:s(()=>[o(y(v.scriptData.updated_at),1)]),_:1})]),_:1}),c.value.length>0?(r(),_("div",$t,[m[5]||(m[5]=i("h4",null,"标签",-1)),i("div",xt,[(r(!0),_(V,null,ae(c.value,u=>(r(),E($,{key:u,color:"blue"},{default:s(()=>[o(y(u),1)]),_:2},1024))),128))])])):D("",!0)])]),_:1}),t(oe,{span:12},{default:s(()=>[i("div",At,[m[10]||(m[10]=i("h3",{class:"section-title"},"详细信息",-1)),v.scriptData.description?(r(),_("div",Lt,[m[7]||(m[7]=i("h4",null,"剧本描述",-1)),i("div",Yt,y(v.scriptData.description),1)])):D("",!0),v.scriptData.props?(r(),_("div",Pt,[m[8]||(m[8]=i("h4",null,"剧本道具",-1)),i("div",Et,y(v.scriptData.props),1)])):D("",!0),i("div",Qt,[m[9]||(m[9]=i("h4",null,"上架门店",-1)),i("div",Zt,[t(ue,{title:"已上架门店",value:O.value.length,suffix:"个","value-style":{color:"#1890ff"}},null,8,["value"])]),O.value.length>0?(r(),_("div",Ot,[t(de,{size:"small","data-source":O.value,split:!1},{renderItem:s(({item:u})=>[t(K,null,{default:s(()=>[i("div",Bt,[i("div",Ft,[i("div",Wt,[i("span",Ut,y(u.store_name),1),t($,{color:u.is_available?"green":"red",size:"small"},{default:s(()=>[o(y(u.is_available?"启用":"禁用"),1)]),_:2},1032,["color"])]),u.store_address?(r(),_("div",Gt,y(u.store_address),1)):D("",!0)]),i("div",Rt,[u.store_price?(r(),_("span",Tt,"Rp "+y(L(u.store_price)),1)):(r(),_("span",Jt,"未设价格"))])])]),_:2},1024)]),_:1},8,["data-source"])])):(r(),_("div",Vt,[t(ce,{description:"暂未在任何门店上架",image:!1,style:{margin:"20px 0"}})]))])])]),_:1})]),_:1})])):D("",!0)]),_:1},8,["open"]),t(e,{open:B.value,"onUpdate:open":m[2]||(m[2]=u=>B.value=u),title:"图片预览",width:"800px",footer:null,centered:""},{default:s(()=>[i("div",Ht,[i("div",qt,[i("img",{src:H(x.value[h.value]),alt:`预览图片 ${h.value+1}`,onError:q},null,40,Kt)]),x.value.length>1?(r(),_("div",Xt,[(r(!0),_(V,null,ae(x.value,(u,g)=>(r(),_("div",{key:g,class:Ie(["preview-thumbnail",{active:h.value===g}]),onClick:z=>h.value=g},[i("img",{src:H(u),onError:q},null,40,ts)],10,es))),128))])):D("",!0),i("div",ss,y(h.value+1)+" / "+y(x.value.length),1)])]),_:1},8,["open"])],64)}}},ls=he(as,[["__scopeId","data-v-5f15070d"]]);const os={class:"script-container"},is={class:"header-actions"},ns={class:"actions"},rs={key:0,class:"script-info"},us={class:"script-images"},ds=["onClick"],cs=["src"],ps={key:0,class:"image-count"},_s={class:"image-preview-hint"},gs={key:1,class:"no-image-placeholder"},vs={class:"script-details"},ms=["onClick"],fs={class:"script-meta"},ys={key:0,class:"script-description"},Ms={key:1,class:"player-info"},bs={class:"player-count"},zs={class:"difficulty"},ks={key:2,class:"duration"},Is={key:0,class:"price"},hs={key:1,class:"no-price"},Ns={key:6,class:"tags-display"},Ds={key:0,class:"more-tags"},js={key:0,class:"batch-actions"},ws={class:"selection-info"},Ss={class:"image-preview-container"},Cs={class:"main-preview"},$s=["src","alt"],xs={key:0,class:"preview-thumbnails"},As=["onClick"],Ls=["src"],Ys={class:"preview-info"},Ps={__name:"ScriptView",setup(v){const Q=Le(),I=J(()=>Q.hasPermission("script.manage")),le=J(()=>Q.hasPermission("script.manage")),Z=J(()=>Q.hasPermission("script.manage")),B=j([]),x=j(!1),h=j([]),b=Se({type:void 0,background:void 0,is_active:void 0,min_players:void 0}),C=j(!1),A=j(!1),k=j(null),F=j(!1),c=j(!1),O=j([]),W=j(0),ie=[{title:"剧本信息",key:"script_info",width:300,fixed:"left"},{title:"游戏设置",key:"players",width:120,align:"center"},{title:"时长",key:"duration",width:80,align:"center"},{title:"价格",key:"price",width:100,align:"center"},{title:"状态",key:"status",width:80,align:"center"},{title:"门店",key:"store_count",width:80,align:"center"},{title:"标签",key:"tags",width:150},{title:"创建时间",dataIndex:"created_at",width:180},{title:"操作",key:"action",width:150,fixed:"right"}],H={selectedRowKeys:h,onChange:d=>{h.value=d}},G=d=>{if(!d.images)return[];if(Array.isArray(d.images))return d.images;try{return JSON.parse(d.images)}catch{return[]}},X=d=>{if(!d.tags)return[];if(Array.isArray(d.tags))return d.tags;try{return JSON.parse(d.tags)}catch{return[]}},ee=d=>d?d.startsWith("http")?d:`http://localhost:3000${d}`:"",q=(d,a=0)=>{!d||d.length===0||(O.value=d,W.value=a,c.value=!0)},L=async()=>{x.value=!0;try{const d={};b.type&&(d.type=b.type),b.background&&(d.background=b.background),b.is_active!==void 0&&(d.is_active=b.is_active),b.min_players&&(d.min_players=b.min_players);const a=await Be(d);B.value=a.data||a||[]}catch(d){console.error("获取剧本列表失败:",d),N.error(`获取剧本列表失败: ${d.message}`)}finally{x.value=!1}},ne=()=>{L()},f=()=>{Object.keys(b).forEach(d=>{b[d]=void 0}),L()},m=()=>{k.value=null,F.value=!1,C.value=!0},$=d=>{k.value=d,A.value=!0},R=async d=>{try{const a=await Fe(d.id);k.value=a.data||a,F.value=!0,C.value=!0}catch(a){console.error("获取剧本详情失败:",a),N.error("获取剧本详情失败")}},re=d=>{De.confirm({title:"确认删除",icon:je(we),content:`确定要删除剧本"${d.name}"吗？删除后相关图片也会被清理。`,onOk:async()=>{try{await Ge(d.id),N.success("删除成功"),L()}catch{N.error("删除失败")}}})},oe=()=>{L()},ue=()=>{h.value=[]},K=async()=>{try{await be({operation:"enable",script_ids:h.value}),N.success("批量启用成功"),h.value=[],L()}catch{N.error("批量启用失败")}},de=async()=>{try{await be({operation:"disable",script_ids:h.value}),N.success("批量禁用成功"),h.value=[],L()}catch{N.error("批量禁用失败")}},ce=()=>{De.confirm({title:"确认批量删除",icon:je(we),content:`确定要删除选中的 ${h.value.length} 个剧本吗？删除后相关图片也会被清理。`,onOk:async()=>{try{await be({operation:"delete",script_ids:h.value}),N.success("批量删除成功"),h.value=[],L()}catch{N.error("批量删除失败")}}})},l=d=>({欢乐:"orange",惊悚:"purple",推理:"blue",恐怖:"red",情感:"pink",策略:"green",血染钟楼:"volcano",桌游:"cyan"})[d]||"default",e=d=>({新手:"green",进阶:"blue",硬核:"red"})[d]||"default",u=d=>({现代:"blue",中国古代:"gold",欧式:"purple",日式:"magenta",架空:"cyan"})[d]||"default",g=d=>{d.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},z=d=>d?new Intl.NumberFormat("id-ID").format(d):"0";return Ye(()=>{console.log("ScriptView组件挂载完成"),L()}),(d,a)=>{const P=M("a-button"),w=M("a-select-option"),te=M("a-select"),T=M("a-form-item"),me=M("a-input-number"),_e=M("a-form"),pe=M("a-card"),se=M("a-tag"),fe=M("a-badge"),ge=M("a-space"),ye=M("a-table"),Me=M("a-modal");return r(),_("div",os,[i("div",is,[a[8]||(a[8]=i("h2",null,"剧本管理",-1)),i("div",ns,[I.value?(r(),E(P,{key:0,type:"primary",onClick:m},{default:s(()=>[t(S(Ce)),a[7]||(a[7]=o(" 新增剧本 "))]),_:1,__:[7]})):D("",!0)])]),t(pe,{class:"filter-card"},{default:s(()=>[t(_e,{layout:"inline",model:b,onFinish:ne},{default:s(()=>[t(T,{label:"剧本类型"},{default:s(()=>[t(te,{value:b.type,"onUpdate:value":a[0]||(a[0]=n=>b.type=n),placeholder:"选择类型",style:{width:"120px"},"allow-clear":""},{default:s(()=>[t(w,{value:"欢乐"},{default:s(()=>a[9]||(a[9]=[o("欢乐")])),_:1,__:[9]}),t(w,{value:"惊悚"},{default:s(()=>a[10]||(a[10]=[o("惊悚")])),_:1,__:[10]}),t(w,{value:"推理"},{default:s(()=>a[11]||(a[11]=[o("推理")])),_:1,__:[11]}),t(w,{value:"恐怖"},{default:s(()=>a[12]||(a[12]=[o("恐怖")])),_:1,__:[12]}),t(w,{value:"情感"},{default:s(()=>a[13]||(a[13]=[o("情感")])),_:1,__:[13]}),t(w,{value:"策略"},{default:s(()=>a[14]||(a[14]=[o("策略")])),_:1,__:[14]}),t(w,{value:"血染钟楼"},{default:s(()=>a[15]||(a[15]=[o("血染钟楼")])),_:1,__:[15]}),t(w,{value:"桌游"},{default:s(()=>a[16]||(a[16]=[o("桌游")])),_:1,__:[16]})]),_:1},8,["value"])]),_:1}),t(T,{label:"剧本背景"},{default:s(()=>[t(te,{value:b.background,"onUpdate:value":a[1]||(a[1]=n=>b.background=n),placeholder:"选择背景",style:{width:"120px"},"allow-clear":""},{default:s(()=>[t(w,{value:"现代"},{default:s(()=>a[17]||(a[17]=[o("现代")])),_:1,__:[17]}),t(w,{value:"中国古代"},{default:s(()=>a[18]||(a[18]=[o("中国古代")])),_:1,__:[18]}),t(w,{value:"欧式"},{default:s(()=>a[19]||(a[19]=[o("欧式")])),_:1,__:[19]}),t(w,{value:"日式"},{default:s(()=>a[20]||(a[20]=[o("日式")])),_:1,__:[20]}),t(w,{value:"架空"},{default:s(()=>a[21]||(a[21]=[o("架空")])),_:1,__:[21]})]),_:1},8,["value"])]),_:1}),t(T,{label:"状态"},{default:s(()=>[t(te,{value:b.is_active,"onUpdate:value":a[2]||(a[2]=n=>b.is_active=n),placeholder:"选择状态",style:{width:"100px"},"allow-clear":""},{default:s(()=>[t(w,{value:!0},{default:s(()=>a[22]||(a[22]=[o("启用")])),_:1,__:[22]}),t(w,{value:!1},{default:s(()=>a[23]||(a[23]=[o("禁用")])),_:1,__:[23]})]),_:1},8,["value"])]),_:1}),t(T,{label:"最少人数"},{default:s(()=>[t(me,{value:b.min_players,"onUpdate:value":a[3]||(a[3]=n=>b.min_players=n),placeholder:"最少人数",min:1,max:20,style:{width:"120px"}},null,8,["value"])]),_:1}),t(T,null,{default:s(()=>[t(P,{type:"primary","html-type":"submit"},{default:s(()=>[t(S(Pe)),a[24]||(a[24]=o(" 查询 "))]),_:1,__:[24]}),t(P,{onClick:f,style:{"margin-left":"8px"}},{default:s(()=>a[25]||(a[25]=[o(" 重置 ")])),_:1,__:[25]})]),_:1})]),_:1},8,["model"])]),_:1}),t(pe,null,{default:s(()=>[t(ye,{columns:ie,"data-source":B.value,loading:x.value,"row-selection":H,"row-key":"id",scroll:{x:1600},pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0}},{bodyCell:s(({column:n,record:p})=>[n.key==="script_info"?(r(),_("div",rs,[i("div",us,[G(p).length>0?(r(),_("div",{key:0,class:"image-gallery",onClick:Y=>q(G(p),0)},[i("img",{src:ee(G(p)[0]),class:"main-script-image",onError:g},null,40,cs),G(p).length>1?(r(),_("div",ps," +"+y(G(p).length-1),1)):D("",!0),i("div",_s,[t(S(ke)),a[26]||(a[26]=o(" 点击预览 "))])],8,ds)):(r(),_("div",gs,[t(S($e))]))]),i("div",vs,[i("div",{class:"script-name",onClick:Y=>$(p)},y(p.name),9,ms),i("div",fs,[t(se,{color:l(p.type),size:"small"},{default:s(()=>[o(y(p.type),1)]),_:2},1032,["color"]),p.background?(r(),E(se,{key:0,color:u(p.background),size:"small"},{default:s(()=>[o(y(p.background),1)]),_:2},1032,["color"])):D("",!0)]),p.description?(r(),_("div",ys,y(p.description.substring(0,50))+y(p.description.length>50?"...":""),1)):D("",!0)])])):n.key==="players"?(r(),_("div",Ms,[i("span",bs,y(p.min_players)+"-"+y(p.max_players)+"人",1),i("div",zs,[t(se,{color:e(p.difficulty),size:"small"},{default:s(()=>[o(y(p.difficulty),1)]),_:2},1032,["color"])])])):n.key==="duration"?(r(),_("span",ks,y(p.duration)+"分钟",1)):n.key==="price"?(r(),_(V,{key:3},[p.price?(r(),_("span",Is,"Rp "+y(z(p.price)),1)):(r(),_("span",hs,"未设置"))],64)):n.key==="status"?(r(),E(se,{key:4,color:p.is_active?"green":"red"},{default:s(()=>[o(y(p.is_active?"启用":"禁用"),1)]),_:2},1032,["color"])):n.key==="store_count"?(r(),E(fe,{key:5,count:p.store_count,"number-style":{backgroundColor:"#1890ff"}},null,8,["count"])):n.key==="tags"?(r(),_("div",Ns,[(r(!0),_(V,null,ae(X(p).slice(0,2),Y=>(r(),E(se,{key:Y,color:"blue",size:"small"},{default:s(()=>[o(y(Y),1)]),_:2},1024))),128)),X(p).length>2?(r(),_("span",Ds," +"+y(X(p).length-2),1)):D("",!0)])):n.key==="action"?(r(),E(ge,{key:7},{default:s(()=>[t(P,{size:"small",type:"link",onClick:Y=>$(p)},{default:s(()=>[t(S(ke)),a[27]||(a[27]=o(" 查看 "))]),_:2,__:[27]},1032,["onClick"]),le.value?(r(),E(P,{key:0,size:"small",type:"link",onClick:Y=>R(p)},{default:s(()=>[t(S(Ee)),a[28]||(a[28]=o(" 编辑 "))]),_:2,__:[28]},1032,["onClick"])):D("",!0),Z.value?(r(),E(P,{key:1,size:"small",type:"link",danger:"",onClick:Y=>re(p)},{default:s(()=>[t(S(ze)),a[29]||(a[29]=o(" 删除 "))]),_:2,__:[29]},1032,["onClick"])):D("",!0)]),_:2},1024)):D("",!0)]),_:1},8,["data-source","loading"]),h.value.length>0?(r(),_("div",js,[t(ge,null,{default:s(()=>[i("span",ws,[t(S(Qe)),o(" 已选择 "+y(h.value.length)+" 项 ",1)]),t(P,{onClick:K,type:"primary",ghost:""},{default:s(()=>[t(S(Ze)),a[30]||(a[30]=o(" 批量启用 "))]),_:1,__:[30]}),t(P,{onClick:de,type:"primary",ghost:""},{default:s(()=>[t(S(Oe)),a[31]||(a[31]=o(" 批量禁用 "))]),_:1,__:[31]}),t(P,{onClick:ce,danger:"",type:"primary",ghost:""},{default:s(()=>[t(S(ze)),a[32]||(a[32]=o(" 批量删除 "))]),_:1,__:[32]}),t(P,{onClick:ue,type:"link"},{default:s(()=>a[33]||(a[33]=[o(" 清空选择 ")])),_:1,__:[33]})]),_:1})])):D("",!0)]),_:1}),t(gt,{visible:C.value,"onUpdate:visible":a[4]||(a[4]=n=>C.value=n),"script-data":k.value,"is-edit":F.value,onSuccess:oe},null,8,["visible","script-data","is-edit"]),t(ls,{visible:A.value,"onUpdate:visible":a[5]||(a[5]=n=>A.value=n),"script-data":k.value},null,8,["visible","script-data"]),t(Me,{open:c.value,"onUpdate:open":a[6]||(a[6]=n=>c.value=n),title:"图片预览",width:"800px",footer:null,centered:""},{default:s(()=>[i("div",Ss,[i("div",Cs,[i("img",{src:ee(O.value[W.value]),alt:`预览图片 ${W.value+1}`,onError:g},null,40,$s)]),O.value.length>1?(r(),_("div",xs,[(r(!0),_(V,null,ae(O.value,(n,p)=>(r(),_("div",{key:p,class:Ie(["preview-thumbnail",{active:W.value===p}]),onClick:Y=>W.value=p},[i("img",{src:ee(n),onError:g},null,40,Ls)],10,As))),128))])):D("",!0),i("div",Ys,y(W.value+1)+" / "+y(O.value.length),1)])]),_:1},8,["open"])])}}},Os=he(Ps,[["__scopeId","data-v-043ebde0"]]);export{Os as default};
