import{a as Ne,r as _,b as oe,k as Q,l as We,q as He,c as b,o as n,d as y,e as X,n as p,w as t,i as w,g as o,m as C,f as Te,P as Ge,h as r,s as x,v as L,t as d}from"./index-979b8016.js";import{u as A}from"./user-5fd5b22f.js";import{_ as Je}from"./_plugin-vue_export-helper-c27b6911.js";const Ke={class:"user-view"},Qe={class:"page-header"},Xe={key:0,style:{color:"#999","margin-left":"8px"}},Ye={key:0,class:"user-detail"},Ze={key:0},ea={key:1},aa={key:0,style:{color:"#999","margin-left":"8px"}},la={style:{"margin-bottom":"16px"}},ta={__name:"UserView",setup(oa){const f=Ne(),Y=_(!1),P=_(!1),D=_(!1),z=_(!1),Z=_(!1),V=_(!1),ee=_(!1),j=_(!1),ae=_(!1),B=_(!1),N=_(!1),ne=_([]),E=_([]),se=_([]),W=_([]),H=_([]),M=_([]),re=_([]),c=_(null),T=_(""),ue=_(),ie=_(),_e=[{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"手机号",dataIndex:"phone",key:"phone",customRender:({text:l})=>l||"-"},{title:"岗位",dataIndex:"position",key:"position",customRender:({text:l})=>l||"-"},{title:"账户级别",dataIndex:"account_level",key:"account_level"},{title:"角色",dataIndex:"role_display_name",key:"role"},{title:"公司",dataIndex:"company_name",key:"company_name",customRender:({text:l})=>l||"-"},{title:"门店",dataIndex:"stores",key:"stores",customRender:({record:l})=>l.stores&&l.stores.length>0?l.stores.map(e=>e.name).join(", "):"-"},{title:"状态",dataIndex:"is_active",key:"is_active"},{title:"创建时间",dataIndex:"created_at",key:"created_at",customRender:({text:l})=>l?new Date(l).toLocaleDateString():"-"},{title:"操作",key:"action"}],m=oe({name:"",email:"",position:"",role_id:"",store_id:"",is_active:void 0}),s=oe({name:"",email:"",phone:"",position:"",account_level:"",role_id:"",store_id:[],password:"",company_id:""}),i=oe({name:"",email:"",phone:"",position:"",account_level:"",role_id:"",stores:[],is_active:!0}),le=Q(()=>f.isPlatformAdmin&&s.account_level&&s.account_level!=="platform"),me=Q(()=>s.account_level==="store"),de=(l,e)=>e?/^8[1-9][0-9]{6,9}$/.test(e)?Promise.resolve():Promise.reject(new Error("请输入有效的印尼手机号（8开头，8-12位数字）")):Promise.resolve(),fe={name:[{required:!0,message:"请输入姓名"}],email:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入正确的邮箱格式"}],phone:[{validator:de}],company_id:[{required:Q(()=>le.value),message:"创建公司级或门店级账户时必须选择公司"}],account_level:[{required:!0,message:"请选择账户级别"}],role_id:[{required:!0,message:"请选择角色"}]},ye={name:[{required:!0,message:"请输入姓名"}],email:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入正确的邮箱格式"}],phone:[{validator:de}],account_level:[{required:!0,message:"请选择账户级别"}],role_id:[{required:!0,message:"请选择角色"}]},G=l=>({platform:"purple",company:"blue",store:"green"})[l]||"default",S=l=>({platform:"平台级",company:"公司级",store:"门店级"})[l]||l,ce=l=>({superadmin:"purple",admin:"blue",manager:"green",supervisor:"orange",service:"cyan",host:"gold"})[l]||"default",ge=Q(()=>f.accountLevel==="platform"||f.accountLevel==="company"||f.accountLevel==="store"),te=l=>{const e={store:1,company:2,platform:3},u=e[f.accountLevel]||1,k=e[l.account_level]||1;return!(u<k||f.accountLevel==="company"&&l.company_id!==f.companyId||f.accountLevel==="store"&&l.account_level!=="store")},be=l=>te(l),we=l=>f.isPlatformAdmin,ke=l=>{var v;if(l.id===((v=f.user)==null?void 0:v.id)||l.account_level==="platform")return!1;const e={store:1,company:2,platform:3},u=e[f.accountLevel]||1,k=e[l.account_level]||1;return u>k},he=async()=>{try{N.value=!0;const l=await A.getCreatableAccountLevels(),e=l.data||l;if(e.creatable_levels)M.value=e.creatable_levels;else{const u=ve();M.value=u}}catch(l){console.error("获取可创建账户级别失败:",l);const e=ve();M.value=e}finally{N.value=!1}},ve=()=>{const l=f.accountLevel;return l==="platform"?["platform","company","store"]:l==="company"?["company","store"]:["store"]},O=async(l=null,e=null)=>{try{if(j.value=!0,l){const u=await A.getRolesByAccountLevel(l,e);E.value=u.data||[]}else{const u=await A.getManageableRoles();E.value=u.data||[]}}catch(u){console.error("获取角色列表失败:",u),C.error("获取角色列表失败")}finally{j.value=!1}},Ue=async()=>{try{ae.value=!0;const l=await A.getAvailableCompanies();se.value=l.data||[]}catch(l){console.error("获取可选公司列表失败:",l),C.error("获取可选公司列表失败")}finally{ae.value=!1}},F=async(l=null)=>{try{B.value=!0;const e=await A.getAvailableStores(l);W.value=e.data||[]}catch(e){console.error("获取可选门店列表失败:",e),C.error("获取可选门店列表失败")}finally{B.value=!1}},Ce=async()=>{try{const l=await A.getAvailablePositions();H.value=l.data||[]}catch(l){console.error("获取可选岗位列表失败:",l),C.error("获取可选岗位列表失败")}},q=async(l={})=>{Y.value=!0;try{const e=await A.getUserList(l);ne.value=e.data||[]}catch(e){console.error("获取用户列表失败:",e),C.error("获取用户列表失败")}finally{Y.value=!1}},xe=l=>{s.company_id="",s.store_id=[],s.role_id="";const e=le.value?s.company_id:f.companyId;if(O(l,e),l==="store"){const u=f.isPlatformAdmin?s.company_id:f.companyId;u&&F(u)}},Le=l=>{s.store_id=[],s.role_id="",s.account_level&&O(s.account_level,l),s.account_level==="store"&&F(l)},Ae=l=>{var u;i.stores=[],i.role_id="";const e=((u=c.value)==null?void 0:u.company_id)||f.companyId;O(l,e),l==="store"&&e&&F(e)},Re=async()=>{try{await ue.value.validate();const l={...s};l.phone&&!l.phone.startsWith("+62")&&(l.phone=`+62${l.phone}`),(!l.company_id||l.company_id.trim()==="")&&(f.companyId?l.company_id=f.companyId:delete l.company_id),(!l.store_id||Array.isArray(l.store_id)&&l.store_id.length===0)&&delete l.store_id,P.value=!0,await A.createUser(l),C.success("用户创建成功"),D.value=!1,Object.keys(s).forEach(e=>{Array.isArray(s[e])?s[e]=[]:s[e]=""}),await q()}catch(l){console.error("创建用户失败:",l)}finally{P.value=!1}},Ie=async l=>{try{const e=await A.getUserDetail(l.id);c.value=e.data,Z.value=!0}catch(e){console.error("获取用户详情失败:",e),C.error("获取用户详情失败")}},Pe=()=>{const l={};Object.keys(m).forEach(e=>{m[e]!==""&&m[e]!==void 0&&m[e]!==null&&(l[e]=m[e])}),q(l)},Se=()=>{Object.keys(m).forEach(l=>{l==="is_active"?m[l]=void 0:m[l]=""}),q()},Fe=async l=>{i.name=l.name||"",i.email=l.email||"",i.phone=l.phone||"",i.position=l.position||"",i.account_level=l.account_level||"",i.role_id=l.role_id||"",i.stores=l.stores?l.stores.map(e=>e.id):[],i.is_active=l.is_active!==void 0?l.is_active:!0,i.phone&&i.phone.startsWith("+62")&&(i.phone=i.phone.substring(3)),c.value=l,z.value=!0,await O(l.account_level,l.company_id),l.account_level==="store"&&F(l.company_id)},qe=async()=>{var l,e;try{await ie.value.validate();const u={...i};u.phone&&!u.phone.startsWith("+62")&&(u.phone=`+62${u.phone}`),P.value=!0,await A.updateUser(c.value.id,u),C.success("用户更新成功"),z.value=!1,await q()}catch(u){console.error("更新用户失败:",u),C.error(((e=(l=u.response)==null?void 0:l.data)==null?void 0:e.error)||"更新用户失败")}finally{P.value=!1}},De=async l=>{var e,u;try{await A.deleteUser(l.id),C.success("用户删除成功"),await q()}catch(k){console.error("删除用户失败:",k),C.error(((u=(e=k.response)==null?void 0:e.data)==null?void 0:u.error)||"删除用户失败")}},Ee=l=>{c.value=l,T.value="",V.value=!0},Me=async()=>{try{ee.value=!0,await A.resetUserPassword(c.value.id,T.value),C.success("密码重置成功"),V.value=!1}catch(l){console.error("重置密码失败:",l),C.error("重置密码失败")}finally{ee.value=!1}};return We(D,l=>{l&&(Object.keys(s).forEach(e=>{Array.isArray(s[e])?s[e]=[]:s[e]=""}),E.value=[],f.accountLevel!=="platform"&&F(f.companyId))}),He(async()=>{await Promise.all([q(),O(),Ue(),he(),Ce(),F()]);try{const l=await A.getManageableRoles();re.value=l.data||[]}catch(l){console.error("获取所有角色失败:",l)}}),(l,e)=>{const u=b("a-button"),k=b("a-input"),v=b("a-form-item"),h=b("a-select-option"),U=b("a-select"),J=b("a-form"),Oe=b("a-card"),I=b("a-tag"),$e=b("a-popconfirm"),ze=b("a-space"),Ve=b("a-table"),pe=b("a-input-password"),K=b("a-modal"),R=b("a-descriptions-item"),je=b("a-descriptions"),Be=b("a-switch");return n(),y("div",Ke,[X("div",Qe,[e[30]||(e[30]=X("h2",null,"用户管理",-1)),ge.value?(n(),p(u,{key:0,type:"primary",onClick:e[0]||(e[0]=a=>D.value=!0)},{default:t(()=>[o(Te(Ge)),e[29]||(e[29]=r(" 添加用户 "))]),_:1,__:[29]})):w("",!0)]),o(Oe,{class:"filter-card",style:{"margin-bottom":"16px"}},{default:t(()=>[o(J,{layout:"inline",model:m,onFinish:Pe},{default:t(()=>[o(v,{label:"姓名"},{default:t(()=>[o(k,{value:m.name,"onUpdate:value":e[1]||(e[1]=a=>m.name=a),placeholder:"请输入姓名",style:{width:"150px"},"allow-clear":""},null,8,["value"])]),_:1}),o(v,{label:"邮箱"},{default:t(()=>[o(k,{value:m.email,"onUpdate:value":e[2]||(e[2]=a=>m.email=a),placeholder:"请输入邮箱",style:{width:"180px"},"allow-clear":""},null,8,["value"])]),_:1}),o(v,{label:"岗位"},{default:t(()=>[o(U,{value:m.position,"onUpdate:value":e[3]||(e[3]=a=>m.position=a),placeholder:"选择岗位",style:{width:"150px"},"allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(H.value,a=>(n(),p(h,{key:a.value,value:a.value},{default:t(()=>[r(d(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(v,{label:"角色"},{default:t(()=>[o(U,{value:m.role_id,"onUpdate:value":e[4]||(e[4]=a=>m.role_id=a),placeholder:"选择角色",style:{width:"150px"},"allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(re.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.display_name||a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(v,{label:"门店"},{default:t(()=>[o(U,{value:m.store_id,"onUpdate:value":e[5]||(e[5]=a=>m.store_id=a),placeholder:"选择门店",style:{width:"150px"},"allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(W.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(v,{label:"状态"},{default:t(()=>[o(U,{value:m.is_active,"onUpdate:value":e[6]||(e[6]=a=>m.is_active=a),placeholder:"选择状态",style:{width:"120px"},"allow-clear":""},{default:t(()=>[o(h,{value:!0},{default:t(()=>e[31]||(e[31]=[r("启用")])),_:1,__:[31]}),o(h,{value:!1},{default:t(()=>e[32]||(e[32]=[r("禁用")])),_:1,__:[32]})]),_:1},8,["value"])]),_:1}),o(v,null,{default:t(()=>[o(u,{type:"primary","html-type":"submit"},{default:t(()=>e[33]||(e[33]=[r(" 查询 ")])),_:1,__:[33]}),o(u,{onClick:Se,style:{"margin-left":"8px"}},{default:t(()=>e[34]||(e[34]=[r(" 重置 ")])),_:1,__:[34]})]),_:1})]),_:1},8,["model"])]),_:1}),o(Ve,{columns:_e,"data-source":ne.value,loading:Y.value,"row-key":"id"},{bodyCell:t(({column:a,record:g})=>[a.key==="account_level"?(n(),p(I,{key:0,color:G(g.account_level)},{default:t(()=>[r(d(S(g.account_level)),1)]),_:2},1032,["color"])):w("",!0),a.key==="role"?(n(),p(I,{key:1,color:ce(g.role_display_name||g.role_name)},{default:t(()=>[r(d(g.role_display_name||g.role_name||"-"),1)]),_:2},1032,["color"])):w("",!0),a.key==="is_active"?(n(),p(I,{key:2,color:g.is_active?"success":"default"},{default:t(()=>[r(d(g.is_active?"启用":"禁用"),1)]),_:2},1032,["color"])):w("",!0),a.key==="action"?(n(),p(ze,{key:3},{default:t(()=>[o(u,{size:"small",onClick:$=>Ie(g)},{default:t(()=>e[35]||(e[35]=[r(" 查看 ")])),_:2,__:[35]},1032,["onClick"]),te(g)?(n(),p(u,{key:0,size:"small",type:"primary",onClick:$=>Fe(g)},{default:t(()=>e[36]||(e[36]=[r(" 编辑 ")])),_:2,__:[36]},1032,["onClick"])):w("",!0),te(g)?(n(),p(u,{key:1,size:"small",onClick:$=>Ee(g)},{default:t(()=>e[37]||(e[37]=[r(" 重置密码 ")])),_:2,__:[37]},1032,["onClick"])):w("",!0),ke(g)?(n(),p($e,{key:2,title:"确定要删除这个用户吗？",onConfirm:$=>De(g)},{default:t(()=>[o(u,{size:"small",danger:""},{default:t(()=>e[38]||(e[38]=[r(" 删除 ")])),_:1,__:[38]})]),_:2},1032,["onConfirm"])):w("",!0)]),_:2},1024)):w("",!0)]),_:1},8,["data-source","loading"]),o(K,{open:D.value,"onUpdate:open":e[16]||(e[16]=a=>D.value=a),title:"添加用户","ok-button-props":{loading:P.value},onOk:Re,width:"600px"},{default:t(()=>[o(J,{ref_key:"createFormRef",ref:ue,model:s,rules:fe,layout:"vertical"},{default:t(()=>[o(v,{label:"姓名",name:"name"},{default:t(()=>[o(k,{value:s.name,"onUpdate:value":e[7]||(e[7]=a=>s.name=a),placeholder:"请输入姓名"},null,8,["value"])]),_:1}),o(v,{label:"邮箱",name:"email"},{default:t(()=>[o(k,{value:s.email,"onUpdate:value":e[8]||(e[8]=a=>s.email=a),placeholder:"请输入邮箱",type:"email"},null,8,["value"])]),_:1}),o(v,{label:"手机号",name:"phone"},{default:t(()=>[o(k,{value:s.phone,"onUpdate:value":e[9]||(e[9]=a=>s.phone=a),placeholder:"请输入印尼手机号（可选）","addon-before":"+62"},null,8,["value"])]),_:1}),o(v,{label:"岗位",name:"position"},{default:t(()=>[o(U,{value:s.position,"onUpdate:value":e[10]||(e[10]=a=>s.position=a),placeholder:"请选择岗位（可选）","allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(H.value,a=>(n(),p(h,{key:a.value,value:a.value},{default:t(()=>[r(d(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(v,{label:"账户级别",name:"account_level"},{default:t(()=>[o(U,{value:s.account_level,"onUpdate:value":e[11]||(e[11]=a=>s.account_level=a),placeholder:"请选择账户级别",loading:N.value,onChange:xe},{default:t(()=>[(n(!0),y(x,null,L(M.value,a=>(n(),p(h,{key:a,value:a},{default:t(()=>[r(d(S(a)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1}),le.value?(n(),p(v,{key:0,label:"公司",name:"company_id"},{default:t(()=>[o(U,{value:s.company_id,"onUpdate:value":e[12]||(e[12]=a=>s.company_id=a),placeholder:"请选择公司",loading:ae.value,onChange:Le},{default:t(()=>[(n(!0),y(x,null,L(se.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.name)+" ",1),o(I,{color:a.type==="直营"?"blue":"green",size:"small",style:{"margin-left":"8px"}},{default:t(()=>[r(d(a.type),1)]),_:2},1032,["color"])]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1})):w("",!0),me.value?(n(),p(v,{key:1,label:"门店",name:"store_id"},{default:t(()=>[o(U,{value:s.store_id,"onUpdate:value":e[13]||(e[13]=a=>s.store_id=a),placeholder:"请选择门店",loading:B.value,mode:"multiple","allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(W.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.name)+" ",1),a.address?(n(),y("span",Xe," ("+d(a.address)+") ",1)):w("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1})):w("",!0),o(v,{label:"角色",name:"role_id"},{default:t(()=>[o(U,{value:s.role_id,"onUpdate:value":e[14]||(e[14]=a=>s.role_id=a),placeholder:"请选择角色",loading:j.value},{default:t(()=>[(n(!0),y(x,null,L(E.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.display_name||a.name)+" ",1),a.role_level?(n(),p(I,{key:0,color:G(a.role_level),size:"small",style:{"margin-left":"8px"}},{default:t(()=>[r(d(S(a.role_level)),1)]),_:2},1032,["color"])):w("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1}),o(v,{label:"初始密码",name:"password"},{default:t(()=>[o(pe,{value:s.password,"onUpdate:value":e[15]||(e[15]=a=>s.password=a),placeholder:"留空将使用默认密码 temp123456"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","ok-button-props"]),o(K,{open:Z.value,"onUpdate:open":e[17]||(e[17]=a=>Z.value=a),title:"用户详情",footer:null,width:"600px"},{default:t(()=>[c.value?(n(),y("div",Ye,[o(je,{column:2,bordered:""},{default:t(()=>[o(R,{label:"姓名"},{default:t(()=>[r(d(c.value.name),1)]),_:1}),o(R,{label:"邮箱"},{default:t(()=>[r(d(c.value.email),1)]),_:1}),o(R,{label:"手机号"},{default:t(()=>[r(d(c.value.phone||"-"),1)]),_:1}),o(R,{label:"岗位"},{default:t(()=>[r(d(c.value.position||"-"),1)]),_:1}),o(R,{label:"账户级别"},{default:t(()=>[o(I,{color:G(c.value.account_level)},{default:t(()=>[r(d(S(c.value.account_level)),1)]),_:1},8,["color"])]),_:1}),o(R,{label:"角色"},{default:t(()=>[o(I,{color:ce(c.value.role_display_name||c.value.role_name)},{default:t(()=>[r(d(c.value.role_display_name||c.value.role_name||"-"),1)]),_:1},8,["color"])]),_:1}),o(R,{label:"公司"},{default:t(()=>[r(d(c.value.company_name||"-"),1)]),_:1}),o(R,{label:"门店"},{default:t(()=>[c.value.stores&&c.value.stores.length>0?(n(),y("div",Ze,[(n(!0),y(x,null,L(c.value.stores,a=>(n(),p(I,{key:a.id,color:"green"},{default:t(()=>[r(d(a.name),1)]),_:2},1024))),128))])):(n(),y("span",ea,"-"))]),_:1}),o(R,{label:"状态"},{default:t(()=>[o(I,{color:c.value.is_active?"success":"default"},{default:t(()=>[r(d(c.value.is_active?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),o(R,{label:"创建时间"},{default:t(()=>[r(d(c.value.created_at?new Date(c.value.created_at).toLocaleString():"-"),1)]),_:1}),o(R,{label:"最后登录",span:"2"},{default:t(()=>[r(d(c.value.last_login_at?new Date(c.value.last_login_at).toLocaleString():"从未登录"),1)]),_:1})]),_:1})])):w("",!0)]),_:1},8,["open"]),o(K,{open:z.value,"onUpdate:open":e[26]||(e[26]=a=>z.value=a),title:"编辑用户","ok-button-props":{loading:P.value},onOk:qe,width:"600px"},{default:t(()=>[o(J,{ref_key:"editFormRef",ref:ie,model:i,rules:ye,layout:"vertical"},{default:t(()=>[o(v,{label:"姓名",name:"name"},{default:t(()=>[o(k,{value:i.name,"onUpdate:value":e[18]||(e[18]=a=>i.name=a),placeholder:"请输入姓名"},null,8,["value"])]),_:1}),o(v,{label:"邮箱",name:"email"},{default:t(()=>[o(k,{value:i.email,"onUpdate:value":e[19]||(e[19]=a=>i.email=a),placeholder:"请输入邮箱",type:"email"},null,8,["value"])]),_:1}),o(v,{label:"手机号",name:"phone"},{default:t(()=>[o(k,{value:i.phone,"onUpdate:value":e[20]||(e[20]=a=>i.phone=a),placeholder:"请输入印尼手机号（可选）","addon-before":"+62"},null,8,["value"])]),_:1}),o(v,{label:"岗位",name:"position"},{default:t(()=>[o(U,{value:i.position,"onUpdate:value":e[21]||(e[21]=a=>i.position=a),placeholder:"请选择岗位（可选）","allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(H.value,a=>(n(),p(h,{key:a.value,value:a.value},{default:t(()=>[r(d(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(v,{label:"账户级别",name:"account_level"},{default:t(()=>[o(U,{value:i.account_level,"onUpdate:value":e[22]||(e[22]=a=>i.account_level=a),placeholder:"请选择账户级别",loading:N.value,disabled:!we(c.value),onChange:Ae},{default:t(()=>[(n(!0),y(x,null,L(M.value,a=>(n(),p(h,{key:a,value:a},{default:t(()=>[r(d(S(a)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading","disabled"])]),_:1}),o(v,{label:"角色",name:"role_id"},{default:t(()=>[o(U,{value:i.role_id,"onUpdate:value":e[23]||(e[23]=a=>i.role_id=a),placeholder:"请选择角色",loading:j.value,disabled:!be(c.value)},{default:t(()=>[(n(!0),y(x,null,L(E.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.display_name||a.name)+" ",1),a.role_level?(n(),p(I,{key:0,color:G(a.role_level),size:"small",style:{"margin-left":"8px"}},{default:t(()=>[r(d(S(a.role_level)),1)]),_:2},1032,["color"])):w("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading","disabled"])]),_:1}),i.account_level==="store"?(n(),p(v,{key:0,label:"门店",name:"stores"},{default:t(()=>[o(U,{value:i.stores,"onUpdate:value":e[24]||(e[24]=a=>i.stores=a),placeholder:"请选择门店",loading:B.value,mode:"multiple","allow-clear":""},{default:t(()=>[(n(!0),y(x,null,L(W.value,a=>(n(),p(h,{key:a.id,value:a.id},{default:t(()=>[r(d(a.name)+" ",1),a.address?(n(),y("span",aa," ("+d(a.address)+") ",1)):w("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1})):w("",!0),o(v,{label:"状态",name:"is_active"},{default:t(()=>[o(Be,{checked:i.is_active,"onUpdate:checked":e[25]||(e[25]=a=>i.is_active=a),"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","ok-button-props"]),o(K,{open:V.value,"onUpdate:open":e[28]||(e[28]=a=>V.value=a),title:"重置密码","ok-button-props":{loading:ee.value},onOk:Me},{default:t(()=>{var a,g;return[X("div",la,[e[39]||(e[39]=X("strong",null,"用户：",-1)),r(d((a=c.value)==null?void 0:a.name)+" ("+d((g=c.value)==null?void 0:g.email)+") ",1)]),o(J,{layout:"vertical"},{default:t(()=>[o(v,{label:"新密码"},{default:t(()=>[o(pe,{value:T.value,"onUpdate:value":e[27]||(e[27]=$=>T.value=$),placeholder:"请输入新密码，留空将使用默认密码 temp123456"},null,8,["value"])]),_:1})]),_:1})]}),_:1},8,["open","ok-button-props"])])}}},ua=Je(ta,[["__scopeId","data-v-d11a881a"]]);export{ua as default};
