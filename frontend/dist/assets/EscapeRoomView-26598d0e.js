import{g as e,A as Ve,x as J,r as b,k as ee,b as Oe,l as Ne,c as g,o as r,n as O,w as s,h as _,e as n,d as c,v as le,t as f,s as te,V as Ge,f as R,P as De,I as Je,K as be,H as ke,i as w,J as Te,m as I,E as je,a as qe,q as Ke,S as Xe,L as et,M as tt,N as at,O as xe,y as Ae,Q as Pe}from"./index-979b8016.js";import{_ as we}from"./_plugin-vue_export-helper-c27b6911.js";import{F as Ye,S as st}from"./StopOutlined-b4edf275.js";var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 276.5a56 56 0 1056-97 56 56 0 00-56 97zm0 284a56 56 0 1056-97 56 56 0 00-56 97zM640 228a56 56 0 10112 0 56 56 0 00-112 0zm0 284a56 56 0 10112 0 56 56 0 00-112 0zM300 844.5a56 56 0 1056-97 56 56 0 00-56 97zM640 796a56 56 0 10112 0 56 56 0 00-112 0z"}}]},name:"holder",theme:"outlined"};const lt=ot;function Le(i){for(var k=1;k<arguments.length;k++){var m=arguments[k]!=null?Object(arguments[k]):{},U=Object.keys(m);typeof Object.getOwnPropertySymbols=="function"&&(U=U.concat(Object.getOwnPropertySymbols(m).filter(function($){return Object.getOwnPropertyDescriptor(m,$).enumerable}))),U.forEach(function($){nt(i,$,m[$])})}return i}function nt(i,k,m){return k in i?Object.defineProperty(i,k,{value:m,enumerable:!0,configurable:!0,writable:!0}):i[k]=m,i}var Ce=function(k,m){var U=Le({},k,m.attrs);return e(Ve,Le({},U,{icon:lt}),null)};Ce.displayName="HolderOutlined";Ce.inheritAttrs=!1;const rt=Ce,it=i=>J({url:"/api/escape-room",method:"get",params:i}),ct=i=>J({url:`/api/escape-room/${i}`,method:"get"}),ut=i=>J({url:"/api/escape-room",method:"post",data:i}),dt=(i,k)=>J({url:`/api/escape-room/${i}`,method:"put",data:k}),pt=i=>J({url:`/api/escape-room/${i}`,method:"delete"}),_t=i=>J({url:"/api/escape-room/upload-images",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}),mt=(i,k)=>J({url:`/api/escape-room/${i}/images`,method:"delete",data:{imageUrl:k}}),Ie=i=>J({url:"/api/escape-room/batch",method:"post",data:i}),vt=()=>J({url:"/api/escape-room/company-stores",method:"get"}),gt=(i,k)=>J({url:`/api/escape-room/${i}/configure-stores`,method:"post",data:{storeConfigs:k}}),Qe=i=>J({url:`/api/escape-room/${i}/store-configs`,method:"get"});const ft={class:"npc-roles-input"},yt={class:"image-upload-container"},ht=["onDragstart","onDrop"],Mt=["src","onLoad"],zt={class:"image-overlay"},bt={class:"image-actions"},It={class:"drag-handle"},Nt={class:"image-order"},Dt={key:1,class:"upload-area"},kt={key:2,class:"sort-tip"},jt={class:"store-config-container"},wt={class:"store-config-header"},Ct={key:0,class:"store-config-list"},$t={class:"store-info"},Rt={class:"store-name"},St={class:"store-address"},Et={key:0,class:"store-price-input"},xt={key:1,class:"no-stores"},At={key:2,class:"stores-loading"},Pt=["src"],Lt={__name:"EscapeRoomFormModal",props:{visible:{type:Boolean,default:!1},escapeRoomData:{type:Object,default:null},isEdit:{type:Boolean,default:!1}},emits:["update:visible","success"],setup(i,{emit:k}){const m=i,U=k,$=b(),T=b(!1),Y=b(!1),j=b(0),M=b(-1),H=b(!1),B=b(""),A=b(),q=b(!1),K=b(""),L=b([]),Q=b(!1),C=b([]),V=ee({get:()=>m.visible,set:t=>U("update:visible",t)}),l=Oe({name:"",horror_level:"",min_players:1,max_players:6,duration:60,npc_count:0,price:null,npc_roles:[],description:"",props:"",cover_images:[],is_active:!0}),ae={name:[{required:!0,message:"ËØ∑ËæìÂÖ•ÂØÜÂÆ§ÂêçÁß∞",trigger:"blur"}],horror_level:[{required:!0,message:"ËØ∑ÈÄâÊã©ÊÅêÊÄñÁ≠âÁ∫ß",trigger:"change"}],min_players:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊúÄÂ∞ë‰∫∫Êï∞",trigger:"blur"},{type:"number",min:1,max:20,message:"‰∫∫Êï∞Â∫îÂú®1-20‰πãÈó¥",trigger:"blur"}],max_players:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊúÄÂ§ö‰∫∫Êï∞",trigger:"blur"},{type:"number",min:1,max:20,message:"‰∫∫Êï∞Â∫îÂú®1-20‰πãÈó¥",trigger:"blur"}],duration:[{required:!0,message:"ËØ∑ËæìÂÖ•Ê∏∏ÊàèÊó∂Èïø",trigger:"blur"},{type:"number",min:1,message:"Êó∂ÈïøÂøÖÈ°ªÂ§ß‰∫é0",trigger:"blur"}]},X=t=>{if(!t)return[];if(Array.isArray(t))return t;try{return JSON.parse(t)}catch{return[]}},se=()=>{Object.keys(l).forEach(t=>{t==="cover_images"||t==="npc_roles"?l[t]=[]:t==="min_players"?l[t]=1:t==="max_players"?l[t]=6:t==="duration"?l[t]=60:t==="npc_count"?l[t]=0:t==="is_active"?l[t]=!0:l[t]=t==="price"?null:""}),C.value=[],$.value&&$.value.resetFields()},Z=()=>{if(m.isEdit&&m.escapeRoomData){const t=m.escapeRoomData;Object.keys(l).forEach(a=>{a==="cover_images"?l[a]=X(t[a])||[]:a==="npc_roles"?l[a]=X(t[a])||[]:t[a]!==void 0&&(l[a]=t[a])})}},y=async()=>{try{Q.value=!0;const t=await vt();L.value=t.data||[]}catch(t){console.error("Ëé∑ÂèñÈó®Â∫óÂàóË°®Â§±Ë¥•:",t),I.error("Ëé∑ÂèñÈó®Â∫óÂàóË°®Â§±Ë¥•")}finally{Q.value=!1}},v=async t=>{if(t)try{console.log("ÂºÄÂßãËé∑ÂèñÂØÜÂÆ§Èó®Â∫óÈÖçÁΩÆ:",t);const N=(await Qe(t)).data||[];console.log("Ëé∑ÂèñÂà∞ÁöÑÈó®Â∫óÈÖçÁΩÆ:",N),C.value=N.map(z=>({store_id:z.store_id,store_price:z.store_price,is_available:z.is_available!==!1})),console.log("ËΩ¨Êç¢ÂêéÁöÑÈó®Â∫óÈÖçÁΩÆ:",C.value)}catch(a){console.error("Ëé∑ÂèñÂØÜÂÆ§Èó®Â∫óÈÖçÁΩÆÂ§±Ë¥•:",a),C.value=[]}},F=t=>C.value.some(a=>a.store_id===t),S=t=>{const a=C.value.find(N=>N.store_id===t);return a?a.store_price:null},_e=(t,a)=>{a?F(t)||C.value.push({store_id:t,store_price:l.price||null,is_available:!0}):C.value=C.value.filter(N=>N.store_id!==t)},re=(t,a)=>{const N=C.value.find(z=>z.store_id===t);N&&(N.store_price=a)},me=()=>{L.value.forEach(t=>{F(t.id)||C.value.push({store_id:t.id,store_price:l.price||null,is_available:!0})})};Ne(()=>m.visible,t=>{var a;t?(y(),Z(),m.isEdit&&((a=m.escapeRoomData)!=null&&a.id)&&v(m.escapeRoomData.id)):se()},{immediate:!0}),Ne(()=>m.escapeRoomData,t=>{t&&m.visible&&(Z(),m.isEdit&&t.id&&v(t.id))},{deep:!0});const ve=()=>{H.value=!0,Te(()=>{var t;(t=A.value)==null||t.focus()})},ie=()=>{const t=B.value.trim();t&&!l.npc_roles.includes(t)&&l.npc_roles.push(t),H.value=!1,B.value=""},ge=t=>{l.npc_roles.splice(t,1)},ce=t=>t?t.startsWith("http")?t:`http://localhost:3000${t}`:"",ue=t=>{t.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},D=t=>{K.value=ce(t),q.value=!0},G=async t=>{var N;const a=l.cover_images[t];if(m.isEdit&&((N=m.escapeRoomData)!=null&&N.id))try{await mt(m.escapeRoomData.id,a),I.success("ÂõæÁâáÂà†Èô§ÊàêÂäü")}catch{I.error("ÂõæÁâáÂà†Èô§Â§±Ë¥•");return}l.cover_images.splice(t,1),j.value++,I.success("ÁßªÈô§ÂõæÁâáÊàêÂäü")},u=(t,a)=>{M.value=t,a.target.classList.add("dragging"),a.dataTransfer.effectAllowed="move"},o=t=>{t.target.classList.remove("dragging"),M.value=-1},E=t=>{var a;t.preventDefault(),(a=t.target.closest(".image-item"))==null||a.classList.add("drag-over")},oe=t=>{var a;(a=t.target.closest(".image-item"))==null||a.classList.remove("drag-over")},fe=(t,a)=>{var P;if(a.preventDefault(),(P=a.target.closest(".image-item"))==null||P.classList.remove("drag-over"),M.value===-1||M.value===t)return;const N=l.cover_images[M.value];l.cover_images.splice(M.value,1);const z=M.value<t?t-1:t;l.cover_images.splice(z,0,N),M.value=-1,j.value++,I.success("ÂõæÁâáÈ°∫Â∫èË∞ÉÊï¥ÊàêÂäü")},ne=async t=>{var z,P;if(console.log("beforeUpload Ê£ÄÊü•Êñá‰ª∂:",{name:t.name,type:t.type,size:t.size,currentImageCount:l.cover_images.length}),!t.type.startsWith("image/"))return console.log("Êñá‰ª∂Á±ªÂûãÊ£ÄÊü•Â§±Ë¥•:",t.type),I.error("Âè™ËÉΩ‰∏ä‰º†ÂõæÁâáÊñá‰ª∂!"),!1;if(!(t.size/1024/1024<5))return console.log("Êñá‰ª∂Â§ßÂ∞èÊ£ÄÊü•Â§±Ë¥•:",t.size/1024/1024,"MB"),I.error("ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB!"),!1;if(l.cover_images.length>=15)return console.log("ÂõæÁâáÊï∞ÈáèÊ£ÄÊü•Â§±Ë¥•:",l.cover_images.length),I.error("ÊúÄÂ§öÂè™ËÉΩ‰∏ä‰º†15Âº†ÂõæÁâá!"),!1;try{Y.value=!0;const h=new FormData;h.append("images",t),console.log("ÂºÄÂßã‰∏ä‰º†ÂõæÁâá:",t.name);const d=await _t(h);console.log("‰∏ä‰º†ÂìçÂ∫î:",d),d.data&&d.data.images?(l.cover_images.push(...d.data.images),console.log("ÂõæÁâá‰∏ä‰º†ÊàêÂäüÔºåÂΩìÂâçÂõæÁâáÊï∞ÁªÑ:",l.cover_images),j.value++,I.success(`ÊàêÂäü‰∏ä‰º† ${d.data.count} Âº†ÂõæÁâá`)):(console.error("ÂõæÁâá‰∏ä‰º†ÂìçÂ∫îÊ†ºÂºèÂºÇÂ∏∏:",d),I.error("ÂõæÁâá‰∏ä‰º†Â§±Ë¥•ÔºöÂìçÂ∫îÊ†ºÂºèÂºÇÂ∏∏"))}catch(h){console.error("ÂõæÁâá‰∏ä‰º†Â§±Ë¥•:",h);let d="ÂõæÁâá‰∏ä‰º†Â§±Ë¥•";(P=(z=h.response)==null?void 0:z.data)!=null&&P.error?d+=`: ${h.response.data.error}`:h.message&&(d+=`: ${h.message}`),I.error(d)}finally{Y.value=!1}return!1},ye=()=>{$.value&&$.value.validate().then(()=>{he()}).catch(t=>{console.error("Ë°®ÂçïÈ™åËØÅÂ§±Ë¥•:",t)})},he=async()=>{var t;if(l.max_players<l.min_players){I.error("ÊúÄÂ§ö‰∫∫Êï∞‰∏çËÉΩÂ∞è‰∫éÊúÄÂ∞ë‰∫∫Êï∞");return}T.value=!0;try{const a={...l,cover_images:JSON.stringify(l.cover_images),npc_roles:JSON.stringify(l.npc_roles)};let N;if(m.isEdit){const z=await dt(m.escapeRoomData.id,a);N=m.escapeRoomData.id,I.success("ÂØÜÂÆ§Êõ¥Êñ∞ÊàêÂäü")}else{const z=await ut(a);N=((t=z.data)==null?void 0:t.id)||z.id,I.success("ÂØÜÂÆ§ÂàõÂª∫ÊàêÂäü")}if(N)try{console.log("‰øùÂ≠òÈó®Â∫óÈÖçÁΩÆ:",C.value),await gt(N,C.value),console.log("Èó®Â∫óÈÖçÁΩÆ‰øùÂ≠òÊàêÂäü"),C.value.length>0&&I.success(`ÂØÜÂÆ§‰øùÂ≠òÊàêÂäüÔºåÂ∑≤ÈÖçÁΩÆ ${C.value.length} ‰∏™Èó®Â∫ó`)}catch(z){console.error("Èó®Â∫óÈÖçÁΩÆ‰øùÂ≠òÂ§±Ë¥•:",z),I.warning("ÂØÜÂÆ§‰øùÂ≠òÊàêÂäüÔºå‰ΩÜÈó®Â∫óÈÖçÁΩÆ‰øùÂ≠òÂ§±Ë¥•")}U("success"),V.value=!1}catch(a){console.error("Êèê‰∫§Â§±Ë¥•:",a),I.error(m.isEdit?"ÂØÜÂÆ§Êõ¥Êñ∞Â§±Ë¥•":"ÂØÜÂÆ§ÂàõÂª∫Â§±Ë¥•")}finally{T.value=!1}},Me=()=>{V.value=!1};return(t,a)=>{const N=g("a-input"),z=g("a-form-item"),P=g("a-col"),h=g("a-select-option"),d=g("a-select"),W=g("a-row"),de=g("a-input-number"),Ze=g("a-switch"),$e=g("a-tag"),Re=g("a-textarea"),ze=g("a-button"),Fe=g("a-upload"),Se=g("a-form-item-rest"),Ue=g("a-checkbox"),Be=g("a-empty"),We=g("a-spin"),He=g("a-form"),Ee=g("a-modal");return r(),O(Ee,{open:V.value,"onUpdate:open":a[13]||(a[13]=p=>V.value=p),title:i.isEdit?"ÁºñËæëÂØÜÂÆ§":"Êñ∞Â¢ûÂØÜÂÆ§",width:"900px","confirm-loading":T.value,onOk:ye,onCancel:Me},{default:s(()=>[e(He,{ref_key:"formRef",ref:$,model:l,rules:ae,layout:"vertical",onFinish:he},{default:s(()=>[e(W,{gutter:16},{default:s(()=>[e(P,{span:12},{default:s(()=>[e(z,{label:"ÂØÜÂÆ§ÂêçÁß∞",name:"name"},{default:s(()=>[e(N,{value:l.name,"onUpdate:value":a[0]||(a[0]=p=>l.name=p),placeholder:"ËØ∑ËæìÂÖ•ÂØÜÂÆ§ÂêçÁß∞"},null,8,["value"])]),_:1})]),_:1}),e(P,{span:12},{default:s(()=>[e(z,{label:"ÊÅêÊÄñÁ≠âÁ∫ß",name:"horror_level"},{default:s(()=>[e(d,{value:l.horror_level,"onUpdate:value":a[1]||(a[1]=p=>l.horror_level=p),placeholder:"ÈÄâÊã©ÊÅêÊÄñÁ≠âÁ∫ß"},{default:s(()=>[e(h,{value:"ÈùûÊÅê"},{default:s(()=>a[14]||(a[14]=[_("ÈùûÊÅê")])),_:1,__:[14]}),e(h,{value:"ÂæÆÊÅê"},{default:s(()=>a[15]||(a[15]=[_("ÂæÆÊÅê")])),_:1,__:[15]}),e(h,{value:"‰∏≠ÊÅê"},{default:s(()=>a[16]||(a[16]=[_("‰∏≠ÊÅê")])),_:1,__:[16]}),e(h,{value:"ÈáçÊÅê"},{default:s(()=>a[17]||(a[17]=[_("ÈáçÊÅê")])),_:1,__:[17]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(W,{gutter:16},{default:s(()=>[e(P,{span:8},{default:s(()=>[e(z,{label:"ÊúÄÂ∞ë‰∫∫Êï∞",name:"min_players"},{default:s(()=>[e(de,{value:l.min_players,"onUpdate:value":a[2]||(a[2]=p=>l.min_players=p),min:1,max:20,style:{width:"100%"},placeholder:"ÊúÄÂ∞ë‰∫∫Êï∞"},null,8,["value"])]),_:1})]),_:1}),e(P,{span:8},{default:s(()=>[e(z,{label:"ÊúÄÂ§ö‰∫∫Êï∞",name:"max_players"},{default:s(()=>[e(de,{value:l.max_players,"onUpdate:value":a[3]||(a[3]=p=>l.max_players=p),min:1,max:20,style:{width:"100%"},placeholder:"ÊúÄÂ§ö‰∫∫Êï∞"},null,8,["value"])]),_:1})]),_:1}),e(P,{span:8},{default:s(()=>[e(z,{label:"Ê∏∏ÊàèÊó∂Èïø(ÂàÜÈíü)",name:"duration"},{default:s(()=>[e(de,{value:l.duration,"onUpdate:value":a[4]||(a[4]=p=>l.duration=p),min:1,style:{width:"100%"},placeholder:"Ê∏∏ÊàèÊó∂Èïø"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(W,{gutter:16},{default:s(()=>[e(P,{span:8},{default:s(()=>[e(z,{label:"NPCÊï∞Èáè",name:"npc_count"},{default:s(()=>[e(de,{value:l.npc_count,"onUpdate:value":a[5]||(a[5]=p=>l.npc_count=p),min:0,style:{width:"100%"},placeholder:"NPCÊï∞Èáè"},null,8,["value"])]),_:1})]),_:1}),e(P,{span:8},{default:s(()=>[e(z,{label:"‰ª∑Ê†º(Rp)",name:"price"},{default:s(()=>[e(de,{value:l.price,"onUpdate:value":a[6]||(a[6]=p=>l.price=p),min:0,precision:0,formatter:p=>`${p}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:p=>p.replace(/\$\s?|(,*)/g,""),style:{width:"100%"},placeholder:"‰ª∑Ê†º"},null,8,["value","formatter","parser"])]),_:1})]),_:1}),e(P,{span:8},{default:s(()=>[e(z,{label:"Áä∂ÊÄÅ",name:"is_active"},{default:s(()=>[e(Ze,{checked:l.is_active,"onUpdate:checked":a[7]||(a[7]=p=>l.is_active=p),"checked-children":"ÂêØÁî®","un-checked-children":"Á¶ÅÁî®"},null,8,["checked"])]),_:1})]),_:1})]),_:1}),e(z,{label:"NPCËßíËâ≤",name:"npc_roles"},{default:s(()=>[n("div",ft,[(r(!0),c(te,null,le(l.npc_roles,(p,x)=>(r(),O($e,{key:x,closable:"",onClose:pe=>ge(x),style:{"margin-bottom":"8px"}},{default:s(()=>[_(f(p),1)]),_:2},1032,["onClose"]))),128)),H.value?(r(),O(N,{key:0,ref_key:"npcRoleInputRef",ref:A,value:B.value,"onUpdate:value":a[8]||(a[8]=p=>B.value=p),type:"text",size:"small",style:{width:"120px"},onBlur:ie,onKeyup:Ge(ie,["enter"])},null,8,["value"])):(r(),O($e,{key:1,onClick:ve,style:{background:"#fff","border-style":"dashed",cursor:"pointer"}},{default:s(()=>[e(R(De)),a[18]||(a[18]=_(" Ê∑ªÂä†ËßíËâ≤ "))]),_:1,__:[18]}))])]),_:1}),e(z,{label:"ÂØÜÂÆ§ÁÆÄ‰ªã",name:"description"},{default:s(()=>[e(Re,{value:l.description,"onUpdate:value":a[9]||(a[9]=p=>l.description=p),rows:4,placeholder:"ËØ∑ËæìÂÖ•ÂØÜÂÆ§ÁÆÄ‰ªã"},null,8,["value"])]),_:1}),e(z,{label:"ÂØÜÂÆ§ÈÅìÂÖ∑",name:"props"},{default:s(()=>[e(Re,{value:l.props,"onUpdate:value":a[10]||(a[10]=p=>l.props=p),rows:3,placeholder:"ËØ∑ËæìÂÖ•ÂØÜÂÆ§ÈÅìÂÖ∑ËØ¥Êòé"},null,8,["value"])]),_:1}),e(z,{label:"Â∞ÅÈù¢ÂõæÁâá"},{default:s(()=>[e(Se,null,{default:s(()=>[n("div",yt,[l.cover_images.length>0?(r(),c("div",{class:"image-list",key:j.value},[(r(!0),c(te,null,le(l.cover_images,(p,x)=>(r(),c("div",{key:`image-${x}-${p}`,class:"image-item",draggable:"true",onDragstart:pe=>u(x,pe),onDragend:o,onDragover:a[11]||(a[11]=Je(()=>{},["prevent"])),onDragenter:E,onDragleave:oe,onDrop:pe=>fe(x,pe)},[n("img",{src:ce(p),onError:ue,onLoad:()=>console.log("ÂõæÁâáÂä†ËΩΩÊàêÂäü:",p)},null,40,Mt),n("div",zt,[n("div",bt,[e(ze,{type:"text",size:"small",onClick:pe=>D(p)},{default:s(()=>[e(R(be),{style:{color:"white"}})]),_:2},1032,["onClick"]),e(ze,{type:"text",size:"small",onClick:pe=>G(x)},{default:s(()=>[e(R(ke),{style:{color:"white"}})]),_:2},1032,["onClick"])]),n("div",It,[e(R(rt),{style:{color:"white"}})])]),n("div",Nt,f(x+1),1)],40,ht))),128))])):w("",!0),l.cover_images.length<15?(r(),c("div",Dt,[e(Fe,{"file-list":[],multiple:!0,"before-upload":ne,"show-upload-list":!1,accept:"image/*"},{default:s(()=>[e(ze,{loading:Y.value},{default:s(()=>[e(R(De)),a[19]||(a[19]=_(" ‰∏ä‰º†ÂõæÁâá "))]),_:1,__:[19]},8,["loading"])]),_:1}),a[20]||(a[20]=n("div",{class:"upload-tips"},[_(" ÊúÄÂ§ö‰∏ä‰º†15Âº†ÂõæÁâáÔºåÂçïÂº†‰∏çË∂ÖËøá5MB"),n("br"),_(" ÊîØÊåÅ JPG„ÄÅPNG„ÄÅGIF„ÄÅWebP Ê†ºÂºè ")],-1))])):w("",!0),l.cover_images.length>1?(r(),c("div",kt," üí° ÂèØÊãñÊãΩÂõæÁâáË∞ÉÊï¥ÊòæÁ§∫È°∫Â∫è ")):w("",!0)])]),_:1})]),_:1}),e(z,{label:"‰∏äÊû∂Èó®Â∫ó"},{default:s(()=>[n("div",jt,[e(Se,null,{default:s(()=>[n("div",wt,[a[22]||(a[22]=n("span",null,"ÈÄâÊã©Ë¶Å‰∏äÊû∂ÁöÑÈó®Â∫óÂπ∂ËÆæÁΩÆ‰ª∑Ê†º",-1)),L.value.length>0?(r(),O(ze,{key:0,type:"link",size:"small",onClick:me},{default:s(()=>a[21]||(a[21]=[_(" ÂÖ®ÈÄâ ")])),_:1,__:[21]})):w("",!0)]),L.value.length>0?(r(),c("div",Ct,[(r(!0),c(te,null,le(L.value,p=>(r(),c("div",{key:p.id,class:"store-config-item"},[e(Ue,{checked:F(p.id),onChange:x=>_e(p.id,x.target.checked)},{default:s(()=>[n("div",$t,[n("span",Rt,f(p.name),1),n("span",St,f(p.address),1)])]),_:2},1032,["checked","onChange"]),F(p.id)?(r(),c("div",Et,[e(de,{value:S(p.id),onChange:x=>re(p.id,x),placeholder:"Èó®Â∫ó‰ª∑Ê†º",min:0,precision:0,formatter:x=>x?new Intl.NumberFormat("id-ID").format(x):"",parser:x=>x.replace(/\D/g,""),size:"small",style:{width:"140px"}},{addonBefore:s(()=>a[23]||(a[23]=[_("Rp")])),_:2},1032,["value","onChange","formatter","parser"])])):w("",!0)]))),128))])):Q.value?w("",!0):(r(),c("div",xt,[e(Be,{description:"ÊöÇÊó†ÂèØÁî®Èó®Â∫ó"})])),Q.value?(r(),c("div",At,[e(We,{size:"small"}),a[24]||(a[24]=n("span",{style:{"margin-left":"8px"}},"Âä†ËΩΩÈó®Â∫óÂàóË°®...",-1))])):w("",!0)]),_:1})])]),_:1})]),_:1},8,["model"]),e(Ee,{open:q.value,"onUpdate:open":a[12]||(a[12]=p=>q.value=p),title:"ÂõæÁâáÈ¢ÑËßà",footer:null,centered:""},{default:s(()=>[n("img",{src:K.value,style:{width:"100%"}},null,8,Pt)]),_:1},8,["open"])]),_:1},8,["open","title","confirm-loading"])}}},Ot=we(Lt,[["__scopeId","data-v-69f5e69f"]]);const Yt={key:0,class:"escape-room-detail"},Qt={class:"detail-section"},Zt={class:"escape-room-header"},Ft={key:0,class:"escape-room-images"},Ut=["src","alt"],Bt={class:"image-preview-hint"},Wt={key:0,class:"image-thumbnails"},Ht=["onClick"],Vt=["src"],Gt={key:1,class:"no-image"},Jt={class:"no-image-placeholder"},Tt={class:"escape-room-basic"},qt={class:"escape-room-name"},Kt={class:"escape-room-meta"},Xt={key:0,class:"price"},ea={key:1,class:"no-price"},ta={key:0,class:"tags-section"},aa={class:"tags-container"},sa={class:"detail-section"},oa={key:0,class:"content-block"},la={class:"content-text"},na={key:1,class:"content-block"},ra={class:"content-text"},ia={class:"content-block"},ca={class:"store-stats"},ua={key:0,class:"store-configs"},da={class:"store-config-item"},pa={class:"store-info"},_a={class:"store-main-info"},ma={class:"store-name"},va={key:0,class:"store-address"},ga={class:"store-price"},fa={key:0,class:"price"},ya={key:1,class:"no-price"},ha={key:1,class:"no-stores"},Ma={class:"image-preview-container"},za={class:"main-preview"},ba=["src","alt"],Ia={key:0,class:"preview-thumbnails"},Na=["onClick"],Da=["src"],ka={class:"preview-info"},ja={__name:"EscapeRoomDetailModal",props:{visible:{type:Boolean,default:!1},escapeRoomData:{type:Object,default:null}},emits:["update:visible"],setup(i,{emit:k}){const m=i,U=k,$=b(0),T=b(!1),Y=b([]),j=b(0),M=b([]),H=b(!1),B=ee({get:()=>m.visible,set:y=>U("update:visible",y)}),A=ee(()=>{var y;if(!((y=m.escapeRoomData)!=null&&y.cover_images))return[];if(Array.isArray(m.escapeRoomData.cover_images))return m.escapeRoomData.cover_images;try{return JSON.parse(m.escapeRoomData.cover_images)}catch{return[]}}),q=ee(()=>A.value.length===0?"":A.value[$.value]||A.value[0]),K=ee(()=>{var y;if(!((y=m.escapeRoomData)!=null&&y.npc_roles))return[];if(Array.isArray(m.escapeRoomData.npc_roles))return m.escapeRoomData.npc_roles;try{return JSON.parse(m.escapeRoomData.npc_roles)}catch{return[]}}),L=ee(()=>M.value.filter(y=>y!==null)),Q=async y=>{if(y)try{H.value=!0;const F=(await Qe(y)).data||[];M.value=F.map(S=>({store_id:S.store_id,store_name:S.store_name,store_address:S.store_address,store_price:S.store_price,is_available:S.is_available!==!1})),console.log("Ëé∑ÂèñÂØÜÂÆ§Èó®Â∫óÈÖçÁΩÆÊàêÂäü:",M.value)}catch(v){console.error("Ëé∑ÂèñÂØÜÂÆ§Èó®Â∫óÈÖçÁΩÆÂ§±Ë¥•:",v),M.value=[]}finally{H.value=!1}};Ne([()=>m.visible,()=>m.escapeRoomData],([y,v])=>{y&&(v!=null&&v.id)&&Q(v.id)},{immediate:!0});const C=()=>{$.value=0,M.value=[],B.value=!1},V=y=>y?y.startsWith("http")?y:`http://localhost:3000${y}`:"",l=y=>({ÈùûÊÅê:"green",ÂæÆÊÅê:"blue",‰∏≠ÊÅê:"orange",ÈáçÊÅê:"red"})[y]||"default",ae=y=>y?new Intl.NumberFormat("id-ID").format(y):"0",X=y=>y?new Date(y).toLocaleString("zh-CN"):"",se=y=>{y.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},Z=(y,v)=>{!y||y.length===0||(Y.value=y,j.value=v,T.value=!0)};return(y,v)=>{const F=g("a-tag"),S=g("a-descriptions-item"),_e=g("a-descriptions"),re=g("a-col"),me=g("a-statistic"),ve=g("a-list-item"),ie=g("a-list"),ge=g("a-empty"),ce=g("a-row"),ue=g("a-modal");return r(),O(ue,{open:B.value,"onUpdate:open":v[2]||(v[2]=D=>B.value=D),title:"ÂØÜÂÆ§ËØ¶ÊÉÖ",width:"1000px",footer:null,centered:"",onCancel:C},{default:s(()=>[i.escapeRoomData?(r(),c("div",Yt,[e(ce,{gutter:24},{default:s(()=>[e(re,{span:12},{default:s(()=>[n("div",Qt,[v[6]||(v[6]=n("h3",{class:"section-title"},"Âü∫Êú¨‰ø°ÊÅØ",-1)),n("div",Zt,[A.value.length>0?(r(),c("div",Ft,[n("div",{class:"main-image",onClick:v[0]||(v[0]=D=>Z(A.value,$.value))},[n("img",{src:V(q.value),alt:i.escapeRoomData.name,onError:se},null,40,Ut),n("div",Bt,[e(R(be)),v[3]||(v[3]=_(" ÁÇπÂáªÊîæÂ§ß "))])]),A.value.length>1?(r(),c("div",Wt,[(r(!0),c(te,null,le(A.value,(D,G)=>(r(),c("div",{key:G,class:je(["thumbnail",{active:$.value===G}]),onClick:u=>$.value=G},[n("img",{src:V(D),onError:se},null,40,Vt)],10,Ht))),128))])):w("",!0)])):(r(),c("div",Gt,[n("div",Jt,[e(R(Ye)),v[4]||(v[4]=n("span",null,"ÊöÇÊó†ÂõæÁâá",-1))])])),n("div",Tt,[n("h2",qt,f(i.escapeRoomData.name),1),n("div",Kt,[e(F,{color:l(i.escapeRoomData.horror_level)},{default:s(()=>[_(f(i.escapeRoomData.horror_level),1)]),_:1},8,["color"]),e(F,{color:i.escapeRoomData.is_active?"green":"red"},{default:s(()=>[_(f(i.escapeRoomData.is_active?"ÂêØÁî®":"Á¶ÅÁî®"),1)]),_:1},8,["color"])])])]),e(_e,{column:1,size:"small",class:"detail-descriptions"},{default:s(()=>[e(S,{label:"Ê∏∏Êàè‰∫∫Êï∞"},{default:s(()=>[_(f(i.escapeRoomData.min_players)+"-"+f(i.escapeRoomData.max_players)+"‰∫∫ ",1)]),_:1}),e(S,{label:"Ê∏∏ÊàèÊó∂Èïø"},{default:s(()=>[_(f(i.escapeRoomData.duration)+"ÂàÜÈíü ",1)]),_:1}),e(S,{label:"NPCÊï∞Èáè"},{default:s(()=>[_(f(i.escapeRoomData.npc_count||0)+"‰∏™ ",1)]),_:1}),e(S,{label:"Âª∫ËÆÆ‰ª∑Ê†º"},{default:s(()=>[i.escapeRoomData.price?(r(),c("span",Xt,"Rp "+f(ae(i.escapeRoomData.price)),1)):(r(),c("span",ea,"Êú™ËÆæÁΩÆ"))]),_:1}),e(S,{label:"ÂàõÂª∫Êó∂Èó¥"},{default:s(()=>[_(f(X(i.escapeRoomData.created_at)),1)]),_:1}),e(S,{label:"Êõ¥Êñ∞Êó∂Èó¥"},{default:s(()=>[_(f(X(i.escapeRoomData.updated_at)),1)]),_:1})]),_:1}),K.value.length>0?(r(),c("div",ta,[v[5]||(v[5]=n("h4",null,"NPCËßíËâ≤",-1)),n("div",aa,[(r(!0),c(te,null,le(K.value,D=>(r(),O(F,{key:D,color:"purple"},{default:s(()=>[_(f(D),1)]),_:2},1024))),128))])])):w("",!0)])]),_:1}),e(re,{span:12},{default:s(()=>[n("div",sa,[v[10]||(v[10]=n("h3",{class:"section-title"},"ËØ¶ÁªÜ‰ø°ÊÅØ",-1)),i.escapeRoomData.description?(r(),c("div",oa,[v[7]||(v[7]=n("h4",null,"ÂØÜÂÆ§ÁÆÄ‰ªã",-1)),n("div",la,f(i.escapeRoomData.description),1)])):w("",!0),i.escapeRoomData.props?(r(),c("div",na,[v[8]||(v[8]=n("h4",null,"ÂØÜÂÆ§ÈÅìÂÖ∑",-1)),n("div",ra,f(i.escapeRoomData.props),1)])):w("",!0),n("div",ia,[v[9]||(v[9]=n("h4",null,"‰∏äÊû∂Èó®Â∫ó",-1)),n("div",ca,[e(me,{title:"Â∑≤‰∏äÊû∂Èó®Â∫ó",value:L.value.length,suffix:"‰∏™","value-style":{color:"#1890ff"}},null,8,["value"])]),L.value.length>0?(r(),c("div",ua,[e(ie,{size:"small","data-source":L.value,split:!1},{renderItem:s(({item:D})=>[e(ve,null,{default:s(()=>[n("div",da,[n("div",pa,[n("div",_a,[n("span",ma,f(D.store_name),1),e(F,{color:D.is_available?"green":"red",size:"small"},{default:s(()=>[_(f(D.is_available?"ÂêØÁî®":"Á¶ÅÁî®"),1)]),_:2},1032,["color"])]),D.store_address?(r(),c("div",va,f(D.store_address),1)):w("",!0)]),n("div",ga,[D.store_price?(r(),c("span",fa,"Rp "+f(ae(D.store_price)),1)):(r(),c("span",ya,"‰ΩøÁî®ÈªòËÆ§‰ª∑Ê†º"))])])]),_:2},1024)]),_:1},8,["data-source"])])):(r(),c("div",ha,[e(ge,{description:"ÊöÇÊú™Âú®‰ªª‰ΩïÈó®Â∫ó‰∏äÊû∂",image:!1,style:{margin:"20px 0"}})]))])])]),_:1})]),_:1})])):w("",!0),e(ue,{open:T.value,"onUpdate:open":v[1]||(v[1]=D=>T.value=D),title:"ÂõæÁâáÈ¢ÑËßà",width:"800px",footer:null,centered:""},{default:s(()=>[n("div",Ma,[n("div",za,[n("img",{src:V(Y.value[j.value]),alt:`È¢ÑËßàÂõæÁâá ${j.value+1}`,onError:se},null,40,ba)]),Y.value.length>1?(r(),c("div",Ia,[(r(!0),c(te,null,le(Y.value,(D,G)=>(r(),c("div",{key:G,class:je(["preview-thumbnail",{active:j.value===G}]),onClick:u=>j.value=G},[n("img",{src:V(D),onError:se},null,40,Da)],10,Na))),128))])):w("",!0),n("div",ka,f(j.value+1)+" / "+f(Y.value.length),1)])]),_:1},8,["open"])]),_:1},8,["open"])}}},wa=we(ja,[["__scopeId","data-v-9f644a48"]]);const Ca={class:"escape-room-container"},$a={class:"header-actions"},Ra={class:"actions"},Sa={key:0,class:"escape-room-info"},Ea={class:"escape-room-images"},xa=["onClick"],Aa=["src"],Pa={key:0,class:"image-count"},La={class:"image-preview-hint"},Oa={key:1,class:"no-image-placeholder"},Ya={class:"escape-room-details"},Qa=["onClick"],Za={class:"escape-room-meta"},Fa={key:0,class:"escape-room-description"},Ua={key:1,class:"player-info"},Ba={class:"player-count"},Wa={key:2,class:"duration"},Ha={key:0,class:"price"},Va={key:1,class:"no-price"},Ga={key:6,class:"npc-roles-display"},Ja={key:0,class:"more-roles"},Ta={key:0,class:"batch-actions"},qa={class:"selection-info"},Ka={class:"image-preview-container"},Xa={class:"main-preview"},es=["src","alt"],ts={key:0,class:"preview-thumbnails"},as=["onClick"],ss=["src"],os={class:"preview-info"},ls={__name:"EscapeRoomView",setup(i){const k=qe(),m=ee(()=>k.hasPermission("escape_room.manage")),U=ee(()=>k.hasPermission("escape_room.manage")),$=ee(()=>k.hasPermission("escape_room.manage")),T=b([]),Y=b(!1),j=b([]),M=Oe({horror_level:void 0,is_active:void 0,min_players:void 0,min_price:void 0}),H=b(!1),B=b(!1),A=b(null),q=b(!1),K=b(!1),L=b([]),Q=b(0),C=[{title:"ÂØÜÂÆ§‰ø°ÊÅØ",key:"escape_room_info",width:300,fixed:"left"},{title:"Ê∏∏ÊàèËÆæÁΩÆ",key:"players",width:120,align:"center"},{title:"Êó∂Èïø",key:"duration",width:80,align:"center"},{title:"‰ª∑Ê†º",key:"price",width:100,align:"center"},{title:"Áä∂ÊÄÅ",key:"status",width:80,align:"center"},{title:"Èó®Â∫ó",key:"store_count",width:80,align:"center"},{title:"NPCËßíËâ≤",key:"npc_roles",width:150},{title:"ÂàõÂª∫Êó∂Èó¥",dataIndex:"created_at",width:180},{title:"Êìç‰Ωú",key:"action",width:150,fixed:"right"}],V={selectedRowKeys:j,onChange:u=>{j.value=u}},l=u=>{if(!u.cover_images)return[];if(Array.isArray(u.cover_images))return u.cover_images;try{return JSON.parse(u.cover_images)}catch{return[]}},ae=u=>{if(!u.npc_roles)return[];if(Array.isArray(u.npc_roles))return u.npc_roles;try{return JSON.parse(u.npc_roles)}catch{return[]}},X=u=>u?u.startsWith("http")?u:`http://localhost:3000${u}`:"",se=(u,o=0)=>{!u||u.length===0||(L.value=u,Q.value=o,K.value=!0)},Z=async()=>{var u;Y.value=!0;try{const o={};M.horror_level&&(o.horror_level=M.horror_level),M.is_active!==void 0&&(o.is_active=M.is_active),M.min_players&&(o.min_players=M.min_players),M.min_price&&(o.min_price=M.min_price);const E=await it(o);T.value=((u=E.data)==null?void 0:u.list)||E.list||E.data||E||[]}catch(o){console.error("Ëé∑ÂèñÂØÜÂÆ§ÂàóË°®Â§±Ë¥•:",o),I.error(`Ëé∑ÂèñÂØÜÂÆ§ÂàóË°®Â§±Ë¥•: ${o.message}`)}finally{Y.value=!1}},y=()=>{Z()},v=()=>{Object.keys(M).forEach(u=>{M[u]=void 0}),Z()},F=()=>{A.value=null,q.value=!1,H.value=!0},S=u=>{A.value=u,B.value=!0},_e=async u=>{try{const o=await ct(u.id);A.value=o.data||o,q.value=!0,H.value=!0}catch(o){console.error("Ëé∑ÂèñÂØÜÂÆ§ËØ¶ÊÉÖÂ§±Ë¥•:",o),I.error("Ëé∑ÂèñÂØÜÂÆ§ËØ¶ÊÉÖÂ§±Ë¥•")}},re=u=>{xe.confirm({title:"Á°ÆËÆ§Âà†Èô§",icon:Ae(Pe),content:`Á°ÆÂÆöË¶ÅÂà†Èô§ÂØÜÂÆ§"${u.name}"ÂêóÔºüÂà†Èô§ÂêéÁõ∏ÂÖ≥ÂõæÁâá‰πü‰ºöË¢´Ê∏ÖÁêÜ„ÄÇ`,onOk:async()=>{try{await pt(u.id),I.success("Âà†Èô§ÊàêÂäü"),Z()}catch{I.error("Âà†Èô§Â§±Ë¥•")}}})},me=()=>{Z()},ve=()=>{j.value=[]},ie=async()=>{try{await Ie({operation:"enable",escape_room_ids:j.value}),I.success("ÊâπÈáèÂêØÁî®ÊàêÂäü"),j.value=[],Z()}catch{I.error("ÊâπÈáèÂêØÁî®Â§±Ë¥•")}},ge=async()=>{try{await Ie({operation:"disable",escape_room_ids:j.value}),I.success("ÊâπÈáèÁ¶ÅÁî®ÊàêÂäü"),j.value=[],Z()}catch{I.error("ÊâπÈáèÁ¶ÅÁî®Â§±Ë¥•")}},ce=()=>{xe.confirm({title:"Á°ÆËÆ§ÊâπÈáèÂà†Èô§",icon:Ae(Pe),content:`Á°ÆÂÆöË¶ÅÂà†Èô§ÈÄâ‰∏≠ÁöÑ ${j.value.length} ‰∏™ÂØÜÂÆ§ÂêóÔºüÂà†Èô§ÂêéÁõ∏ÂÖ≥ÂõæÁâá‰πü‰ºöË¢´Ê∏ÖÁêÜ„ÄÇ`,onOk:async()=>{try{await Ie({operation:"delete",escape_room_ids:j.value}),I.success("ÊâπÈáèÂà†Èô§ÊàêÂäü"),j.value=[],Z()}catch{I.error("ÊâπÈáèÂà†Èô§Â§±Ë¥•")}}})},ue=u=>({ÈùûÊÅê:"green",ÂæÆÊÅê:"blue",‰∏≠ÊÅê:"orange",ÈáçÊÅê:"red"})[u]||"default",D=u=>{u.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yMS4zMzMzIDIxLjMzMzNIMTZWNDIuNjY2N0g0OFYyMS4zMzMzSDQyLjY2NjdMMzggMTZIMjZMMjEuMzMzMyAyMS4zMzMzWiIgZmlsbD0iI0NDQ0NDQyIvPgo8cGF0aCBkPSJNMzIgMzcuMzMzM0MzNS42ODEzIDM3LjMzMzMgMzguNjY2NyAzNC4zNDc5IDM4LjY2NjcgMzFDMzguNjY2NyAyNy42NTIxIDM1LjY4MTMgMjQuNjY2NyAzMiAyNC42NjY3QzI4LjMxODcgMjQuNjY2NyAyNS4zMzMzIDI3LjY1MjEgMjUuMzMzMyAzMUMyNS4zMzMzIDM0LjM0NzkgMjguMzE4NyAzNy4zMzMzIDMyIDM3LjMzMzNaIiBmaWxsPSIjQ0NDQ0NDIi8+Cjwvc3ZnPgo="},G=u=>u?new Intl.NumberFormat("id-ID").format(u):"0";return Ke(()=>{console.log("EscapeRoomViewÁªÑ‰ª∂ÊåÇËΩΩÂÆåÊàê"),Z()}),(u,o)=>{const E=g("a-button"),oe=g("a-select-option"),fe=g("a-select"),ne=g("a-form-item"),ye=g("a-input-number"),he=g("a-form"),Me=g("a-card"),t=g("a-tag"),a=g("a-badge"),N=g("a-space"),z=g("a-table"),P=g("a-modal");return r(),c("div",Ca,[n("div",$a,[o[8]||(o[8]=n("h2",null,"ÂØÜÂÆ§ÁÆ°ÁêÜ",-1)),n("div",Ra,[m.value?(r(),O(E,{key:0,type:"primary",onClick:F},{default:s(()=>[e(R(De)),o[7]||(o[7]=_(" Êñ∞Â¢ûÂØÜÂÆ§ "))]),_:1,__:[7]})):w("",!0)])]),e(Me,{class:"filter-card"},{default:s(()=>[e(he,{layout:"inline",model:M,onFinish:y},{default:s(()=>[e(ne,{label:"ÊÅêÊÄñÁ≠âÁ∫ß"},{default:s(()=>[e(fe,{value:M.horror_level,"onUpdate:value":o[0]||(o[0]=h=>M.horror_level=h),placeholder:"ÈÄâÊã©ÊÅêÊÄñÁ≠âÁ∫ß",style:{width:"120px"},"allow-clear":""},{default:s(()=>[e(oe,{value:"ÈùûÊÅê"},{default:s(()=>o[9]||(o[9]=[_("ÈùûÊÅê")])),_:1,__:[9]}),e(oe,{value:"ÂæÆÊÅê"},{default:s(()=>o[10]||(o[10]=[_("ÂæÆÊÅê")])),_:1,__:[10]}),e(oe,{value:"‰∏≠ÊÅê"},{default:s(()=>o[11]||(o[11]=[_("‰∏≠ÊÅê")])),_:1,__:[11]}),e(oe,{value:"ÈáçÊÅê"},{default:s(()=>o[12]||(o[12]=[_("ÈáçÊÅê")])),_:1,__:[12]})]),_:1},8,["value"])]),_:1}),e(ne,{label:"Áä∂ÊÄÅ"},{default:s(()=>[e(fe,{value:M.is_active,"onUpdate:value":o[1]||(o[1]=h=>M.is_active=h),placeholder:"ÈÄâÊã©Áä∂ÊÄÅ",style:{width:"100px"},"allow-clear":""},{default:s(()=>[e(oe,{value:!0},{default:s(()=>o[13]||(o[13]=[_("ÂêØÁî®")])),_:1,__:[13]}),e(oe,{value:!1},{default:s(()=>o[14]||(o[14]=[_("Á¶ÅÁî®")])),_:1,__:[14]})]),_:1},8,["value"])]),_:1}),e(ne,{label:"ÊúÄÂ∞ë‰∫∫Êï∞"},{default:s(()=>[e(ye,{value:M.min_players,"onUpdate:value":o[2]||(o[2]=h=>M.min_players=h),placeholder:"ÊúÄÂ∞ë‰∫∫Êï∞",min:1,max:20,style:{width:"120px"}},null,8,["value"])]),_:1}),e(ne,{label:"‰ª∑Ê†ºËåÉÂõ¥"},{default:s(()=>[e(ye,{value:M.min_price,"onUpdate:value":o[3]||(o[3]=h=>M.min_price=h),placeholder:"ÊúÄ‰Ωé‰ª∑Ê†º",min:0,style:{width:"120px"}},null,8,["value"])]),_:1}),e(ne,null,{default:s(()=>[e(E,{type:"primary","html-type":"submit"},{default:s(()=>[e(R(Xe)),o[15]||(o[15]=_(" Êü•ËØ¢ "))]),_:1,__:[15]}),e(E,{onClick:v,style:{"margin-left":"8px"}},{default:s(()=>o[16]||(o[16]=[_(" ÈáçÁΩÆ ")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])]),_:1}),e(Me,null,{default:s(()=>[e(z,{columns:C,"data-source":T.value,loading:Y.value,"row-selection":V,"row-key":"id",scroll:{x:1600},pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0}},{bodyCell:s(({column:h,record:d})=>[h.key==="escape_room_info"?(r(),c("div",Sa,[n("div",Ea,[l(d).length>0?(r(),c("div",{key:0,class:"image-gallery",onClick:W=>se(l(d),0)},[n("img",{src:X(l(d)[0]),class:"main-escape-room-image",onError:D},null,40,Aa),l(d).length>1?(r(),c("div",Pa," +"+f(l(d).length-1),1)):w("",!0),n("div",La,[e(R(be)),o[17]||(o[17]=_(" ÁÇπÂáªÈ¢ÑËßà "))])],8,xa)):(r(),c("div",Oa,[e(R(Ye))]))]),n("div",Ya,[n("div",{class:"escape-room-name",onClick:W=>S(d)},f(d.name),9,Qa),n("div",Za,[e(t,{color:ue(d.horror_level),size:"small"},{default:s(()=>[_(f(d.horror_level),1)]),_:2},1032,["color"]),d.npc_count>0?(r(),O(t,{key:0,color:"blue",size:"small"},{default:s(()=>[_(f(d.npc_count)+"‰∏™NPC ",1)]),_:2},1024)):w("",!0)]),d.description?(r(),c("div",Fa,f(d.description.substring(0,50))+f(d.description.length>50?"...":""),1)):w("",!0)])])):h.key==="players"?(r(),c("div",Ua,[n("span",Ba,f(d.min_players)+"-"+f(d.max_players)+"‰∫∫",1)])):h.key==="duration"?(r(),c("span",Wa,f(d.duration)+"ÂàÜÈíü",1)):h.key==="price"?(r(),c(te,{key:3},[d.price?(r(),c("span",Ha,"Rp "+f(G(d.price)),1)):(r(),c("span",Va,"Êú™ËÆæÁΩÆ"))],64)):h.key==="status"?(r(),O(t,{key:4,color:d.is_active?"green":"red"},{default:s(()=>[_(f(d.is_active?"ÂêØÁî®":"Á¶ÅÁî®"),1)]),_:2},1032,["color"])):h.key==="store_count"?(r(),O(a,{key:5,count:d.store_count||0,"number-style":{backgroundColor:"#1890ff"}},null,8,["count"])):h.key==="npc_roles"?(r(),c("div",Ga,[(r(!0),c(te,null,le(ae(d).slice(0,2),W=>(r(),O(t,{key:W,color:"purple",size:"small"},{default:s(()=>[_(f(W),1)]),_:2},1024))),128)),ae(d).length>2?(r(),c("span",Ja," +"+f(ae(d).length-2),1)):w("",!0)])):h.key==="action"?(r(),O(N,{key:7},{default:s(()=>[e(E,{size:"small",type:"link",onClick:W=>S(d)},{default:s(()=>[e(R(be)),o[18]||(o[18]=_(" Êü•Áúã "))]),_:2,__:[18]},1032,["onClick"]),U.value?(r(),O(E,{key:0,size:"small",type:"link",onClick:W=>_e(d)},{default:s(()=>[e(R(et)),o[19]||(o[19]=_(" ÁºñËæë "))]),_:2,__:[19]},1032,["onClick"])):w("",!0),$.value?(r(),O(E,{key:1,size:"small",type:"link",danger:"",onClick:W=>re(d)},{default:s(()=>[e(R(ke)),o[20]||(o[20]=_(" Âà†Èô§ "))]),_:2,__:[20]},1032,["onClick"])):w("",!0)]),_:2},1024)):w("",!0)]),_:1},8,["data-source","loading"]),j.value.length>0?(r(),c("div",Ta,[e(N,null,{default:s(()=>[n("span",qa,[e(R(tt)),_(" Â∑≤ÈÄâÊã© "+f(j.value.length)+" È°π ",1)]),e(E,{onClick:ie,type:"primary",ghost:""},{default:s(()=>[e(R(at)),o[21]||(o[21]=_(" ÊâπÈáèÂêØÁî® "))]),_:1,__:[21]}),e(E,{onClick:ge,type:"primary",ghost:""},{default:s(()=>[e(R(st)),o[22]||(o[22]=_(" ÊâπÈáèÁ¶ÅÁî® "))]),_:1,__:[22]}),e(E,{onClick:ce,danger:"",type:"primary",ghost:""},{default:s(()=>[e(R(ke)),o[23]||(o[23]=_(" ÊâπÈáèÂà†Èô§ "))]),_:1,__:[23]}),e(E,{onClick:ve,type:"link"},{default:s(()=>o[24]||(o[24]=[_(" Ê∏ÖÁ©∫ÈÄâÊã© ")])),_:1,__:[24]})]),_:1})])):w("",!0)]),_:1}),e(Ot,{visible:H.value,"onUpdate:visible":o[4]||(o[4]=h=>H.value=h),"escape-room-data":A.value,"is-edit":q.value,onSuccess:me},null,8,["visible","escape-room-data","is-edit"]),e(wa,{visible:B.value,"onUpdate:visible":o[5]||(o[5]=h=>B.value=h),"escape-room-data":A.value},null,8,["visible","escape-room-data"]),e(P,{open:K.value,"onUpdate:open":o[6]||(o[6]=h=>K.value=h),title:"ÂõæÁâáÈ¢ÑËßà",width:"800px",footer:null,centered:""},{default:s(()=>[n("div",Ka,[n("div",Xa,[n("img",{src:X(L.value[Q.value]),alt:`È¢ÑËßàÂõæÁâá ${Q.value+1}`,onError:D},null,40,es)]),L.value.length>1?(r(),c("div",ts,[(r(!0),c(te,null,le(L.value,(h,d)=>(r(),c("div",{key:d,class:je(["preview-thumbnail",{active:Q.value===d}]),onClick:W=>Q.value=d},[n("img",{src:X(h),onError:D},null,40,ss)],10,as))),128))])):w("",!0),n("div",os,f(Q.value+1)+" / "+f(L.value.length),1)])]),_:1},8,["open"])])}}},cs=we(ls,[["__scopeId","data-v-74c09f23"]]);export{cs as default};
